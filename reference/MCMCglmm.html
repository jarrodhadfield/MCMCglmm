<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Multivariate Generalised Linear Mixed Models — MCMCglmm • MCMCglmm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multivariate Generalised Linear Mixed Models — MCMCglmm"><meta name="description" content='Markov chain Monte Carlo Sampler for Multivariate Generalised Linear Mixed
Models with special emphasis on correlated random effects arising from pedigrees
and phylogenies (Hadfield 2010). Please read the course notes: vignette("CourseNotes",
"MCMCglmm") or the overview vignette("Overview", "MCMCglmm")'><meta property="og:description" content='Markov chain Monte Carlo Sampler for Multivariate Generalised Linear Mixed
Models with special emphasis on correlated random effects arising from pedigrees
and phylogenies (Hadfield 2010). Please read the course notes: vignette("CourseNotes",
"MCMCglmm") or the overview vignette("Overview", "MCMCglmm")'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MCMCglmm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.37</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../course-notes/overview.html">Course Notes</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/jarrodhadfield/MCMCglmm"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Multivariate Generalised Linear Mixed Models</h1>

      <div class="d-none name"><code>MCMCglmm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Markov chain Monte Carlo Sampler for Multivariate Generalised Linear Mixed
Models with special emphasis on correlated random effects arising from pedigrees
and phylogenies (Hadfield 2010). Please read the course notes: <code><a href="../articles/CourseNotes.html">vignette("CourseNotes",
"MCMCglmm")</a></code> or the overview <code>vignette("Overview", "MCMCglmm")</code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MCMCglmm</span><span class="op">(</span><span class="va">fixed</span>, random<span class="op">=</span><span class="cn">NULL</span>, rcov<span class="op">=</span><span class="op">~</span><span class="va">units</span>, family<span class="op">=</span><span class="st">"gaussian"</span>, mev<span class="op">=</span><span class="cn">NULL</span>, </span>
<span>    <span class="va">data</span>,start<span class="op">=</span><span class="cn">NULL</span>, prior<span class="op">=</span><span class="cn">NULL</span>, tune<span class="op">=</span><span class="cn">NULL</span>, pedigree<span class="op">=</span><span class="cn">NULL</span>, nodes<span class="op">=</span><span class="st">"ALL"</span>,</span>
<span>    scale<span class="op">=</span><span class="cn">TRUE</span>, nitt<span class="op">=</span><span class="fl">13000</span>, thin<span class="op">=</span><span class="fl">10</span>, burnin<span class="op">=</span><span class="fl">3000</span>, pr<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>    pl<span class="op">=</span><span class="cn">FALSE</span>, verbose<span class="op">=</span><span class="cn">TRUE</span>, DIC<span class="op">=</span><span class="cn">TRUE</span>, singular.ok<span class="op">=</span><span class="cn">FALSE</span>, saveX<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>    saveZ<span class="op">=</span><span class="cn">TRUE</span>, saveXL<span class="op">=</span><span class="cn">TRUE</span>, slice<span class="op">=</span><span class="cn">FALSE</span>, ginverse<span class="op">=</span><span class="cn">NULL</span>, trunc<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>    theta_scale<span class="op">=</span><span class="cn">NULL</span>, saveWS<span class="op">=</span><span class="cn">TRUE</span>, aggregate<span class="op">=</span><span class="cn">NULL</span>, longer<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-fixed">fixed<a class="anchor" aria-label="anchor" href="#arg-fixed"></a></dt>
<dd><p><code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></code> for the fixed effects, multiple responses are passed as a matrix using cbind</p></dd>

  <dt id="arg-random">random<a class="anchor" aria-label="anchor" href="#arg-random"></a></dt>
<dd><p><code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></code> for the random effects. Multiple random terms can be passed using the <code>+</code> operator, and in the most general case each random term has the form <code>variance.function(formula):linking.function(random.terms)</code>. Currently, the only <code>variance.functions</code> available are <code>idv</code>, <code>idh</code>, <code>us</code>, <code>cor[]</code> and <code>ante[]</code>. <code>idv</code> fits a constant variance across all components in <code>formula</code>. Both <code>idh</code> and <code>us</code> fit different variances across each component in <code>formula</code>, but <code>us</code> will also fit the covariances. <code>corg</code> fixes the variances along the diagonal to one and <code>corgh</code> fixes the variances along the diagonal to those specified in the prior.  <code>cors</code> allows correlation submatrices. <code>ante[]</code> fits ante-dependence structures of different order (e.g ante1, ante2), and the number can be prefixed by a <code>c</code> to hold all regression coefficients of the same order equal. The number can also be suffixed by a <code>v</code> to hold all innovation variances equal (e.g <code>antec2v</code> has 3 parameters).  The <code>formula</code> can contain both factors and numeric terms (i.e. random regression) although it should be noted that the intercept term is suppressed.  The (co)variances are the (co)variances of the <code>random.terms</code> effects.  Currently, the only <code>linking.functions</code> available are <code>mm</code> and <code>str</code>. <code>mm</code> fits a multimembership model where multiple random terms are separated by the <code>+</code> operator. <code>str</code> allows covariances to exist between multiple random terms that are also separated by the <code>+</code> operator. In both cases the levels of all multiple random terms have to be the same.  For simpler models the <code>variance.function(formula)</code> and <code>linking.function(random.terms)</code> can be omitted and the model syntax has the simpler form <code>~random1+random2+...</code>.  There are two reserved variables: <code>units</code> which index rows of the response variable and <code>trait</code> which index columns of the response variable</p></dd>

  <dt id="arg-rcov">rcov<a class="anchor" aria-label="anchor" href="#arg-rcov"></a></dt>
<dd><p><code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></code> for residual covariance structure. This has to be set up so that each data point is associated with a unique residual. For example a multi-response model might have the R-structure defined by <code>~us(trait):units</code></p></dd>

  <dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>optional character vector of trait distributions. Currently, <code>"gaussian"</code>, <code>"poisson"</code>,  <code>"categorical"</code>, <code>"multinomial"</code>,  <code>"ordinal"</code>, <code>"threshold"</code>, <code>"exponential"</code>, <code>"geometric"</code>, <code>"cengaussian"</code>, <code>"cenpoisson"</code>,  <code>"cenexponential"</code>,  <code>"zipoisson"</code>, <code>"zapoisson"</code>, <code>"ztpoisson"</code>, <code>"hupoisson"</code>, <code>"zibinomial"</code>, <code>"threshold"</code>, <code>"nzbinom"</code> , <code>"ncst"</code>, <code>"msst"</code> , <code>"hubinomial"</code>, <code>"ztmb"</code> and <code>"ztmultinomial"</code> are supported, where the prefix <code>"cen"</code> means censored, the prefix <code>"zi"</code> means zero inflated, the prefix <code>"za"</code> means zero altered, the prefix <code>"zt"</code> means zero truncated and the prefix <code>"hu"</code> means hurdle. If <code>NULL</code>, <code>data</code> needs to contain a <code>family</code> column.</p></dd>

  <dt id="arg-mev">mev<a class="anchor" aria-label="anchor" href="#arg-mev"></a></dt>
<dd><p>optional vector of measurement error variances for each data point for random effect meta-analysis.</p></dd>

  <dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p><code>data.frame</code></p></dd>

  <dt id="arg-start">start<a class="anchor" aria-label="anchor" href="#arg-start"></a></dt>
<dd><p>optional list having 5 possible elements: <code>R</code> (R-structure) <code>G</code> (G-structure) and <code>Liab</code> (latent variables or liabilities) should contain the starting values where <code>G</code> itself is also a list with as many elements as random effect components. The element <code>QUASI</code> should be logical: if <code>TRUE</code> starting latent variables are obtained heuristically, if <code>FALSE</code> then they are sampled from a Z-distribution. The element <code>r</code> should be be between -1 and 1 and determines the correlation between the starting latent variables and the ordered latent variables (ordered by the response variable): the default is 0.8.</p></dd>

  <dt id="arg-prior">prior<a class="anchor" aria-label="anchor" href="#arg-prior"></a></dt>
<dd><p>optional list of prior specifications having 4 possible elements: <code>R</code> (R-structure) <code>G</code> (G-structure), <code>B</code> (fixed effects) and <code>S</code> (theta_scale parameter). <code>B</code> and <code>S</code> are lists containing the expected value (<code>mu</code>) and a (co)variance matrix (<code>V</code>) representing the strength of belief: the defaults are <code>B$mu</code>=<code>S$mu</code>=0 and <code>B$V</code>=<code>S$V</code>=I*1e+10, where where I is an identity matrix of appropriate dimension.  The priors for the variance structures (<code>R</code> and <code>G</code>) are lists with the expected (co)variances (<code>V</code>) and degree of belief parameter (<code>nu</code>) for the inverse-Wishart (note this parameterisation is non-standard - see <a href="rIW.html">rIW</a>), and also the mean vector (<code>alpha.mu</code>) and covariance matrix (<code>alpha.V</code>) for the redundant working parameters. The defaults are <code>nu</code>=0, <code>V</code>=1, <code>alpha.mu</code>=0, and <code>alpha.V</code>=0. When <code>alpha.V</code> is non-zero, parameter expanded algorithms are used.</p></dd>

  <dt id="arg-tune">tune<a class="anchor" aria-label="anchor" href="#arg-tune"></a></dt>
<dd><p>optional list with elements <code>mh_V</code> and/or <code>mh_weights</code> <code>mh_V</code> should be a list with as many elements as there are R-structure terms with each element being the (co)variance matrix defining the proposal distribution for the associated latent variables. If NULL an adaptive algorithm is used which ceases to adapt once the burn-in phase has finished. <code>mh_weights</code> should be equal to the number of latent variables and acts as a scaling factor for the proposal standard deviations.</p></dd>

  <dt id="arg-pedigree">pedigree<a class="anchor" aria-label="anchor" href="#arg-pedigree"></a></dt>
<dd><p>ordered pedigree with 3 columns id, dam and sire or a <code>phylo</code> object. This argument is retained for back compatibility - see ginverse argument for a more general formulation.</p></dd>

  <dt id="arg-nodes">nodes<a class="anchor" aria-label="anchor" href="#arg-nodes"></a></dt>
<dd><p>pedigree/phylogeny nodes to be estimated. The default, <code>"ALL"</code> estimates effects for all individuals in a pedigree or nodes in a phylogeny (including ancestral nodes). For phylogenies <code>"TIPS"</code> estimates effects for the tips only, and for pedigrees a vector of ids can be passed to <code>nodes</code> specifying the subset of individuals for which animal effects are estimated.  Note that all analyses are equivalent if omitted nodes have missing data but by absorbing these nodes the chain max mix better. However, the algorithm may be less numerically stable and may iterate slower, especially for large phylogenies.</p></dd>

  <dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>logical: should the phylogeny (needs to be ultrametric) be scaled to unit length (distance from root to tip)?</p></dd>

  <dt id="arg-nitt">nitt<a class="anchor" aria-label="anchor" href="#arg-nitt"></a></dt>
<dd><p>number of MCMC iterations</p></dd>

  <dt id="arg-thin">thin<a class="anchor" aria-label="anchor" href="#arg-thin"></a></dt>
<dd><p>thinning interval</p></dd>

  <dt id="arg-burnin">burnin<a class="anchor" aria-label="anchor" href="#arg-burnin"></a></dt>
<dd><p>burnin</p></dd>

  <dt id="arg-pr">pr<a class="anchor" aria-label="anchor" href="#arg-pr"></a></dt>
<dd><p>logical: should the posterior distribution of random effects be saved?</p></dd>

  <dt id="arg-pl">pl<a class="anchor" aria-label="anchor" href="#arg-pl"></a></dt>
<dd><p>logical: should the posterior distribution of latent variables be saved?</p></dd>

  <dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>logical: if <code>TRUE</code> MH diagnostics are printed to screen</p></dd>

  <dt id="arg-dic">DIC<a class="anchor" aria-label="anchor" href="#arg-dic"></a></dt>
<dd><p>logical: if <code>TRUE</code> deviance and deviance information criterion are calculated</p></dd>

  <dt id="arg-singular-ok">singular.ok<a class="anchor" aria-label="anchor" href="#arg-singular-ok"></a></dt>
<dd><p>logical: if <code>FALSE</code> linear dependencies in the fixed effects are removed. if <code>TRUE</code> they are left in an estimated, although all information comes form the prior</p></dd>

  <dt id="arg-savex">saveX<a class="anchor" aria-label="anchor" href="#arg-savex"></a></dt>
<dd><p>logical: save fixed effect design matrix</p></dd>

  <dt id="arg-savez">saveZ<a class="anchor" aria-label="anchor" href="#arg-savez"></a></dt>
<dd><p>logical: save random effect design matrix</p></dd>

  <dt id="arg-savexl">saveXL<a class="anchor" aria-label="anchor" href="#arg-savexl"></a></dt>
<dd><p>logical: save structural parameter design matrix</p></dd>

  <dt id="arg-slice">slice<a class="anchor" aria-label="anchor" href="#arg-slice"></a></dt>
<dd><p>logical: should slice sampling be used? Only applicable for binary traits with independent residuals</p></dd>

  <dt id="arg-ginverse">ginverse<a class="anchor" aria-label="anchor" href="#arg-ginverse"></a></dt>
<dd><p>a list of sparse inverse matrices (\({\bf A^{-1}}\)) that are proportional to the covariance structure of the random effects. The names of the matrices should correspond to columns in <code>data</code> that are associated with the random term. All levels of the random term should appear as rownames for the matrices.</p></dd>

  <dt id="arg-trunc">trunc<a class="anchor" aria-label="anchor" href="#arg-trunc"></a></dt>
<dd><p>logical: should latent variables in binary models be truncated to prevent under/overflow (+/-20 for categorical/multinomial models and +/-7 for threshold/probit models)?</p></dd>

  <dt id="arg-theta-scale">theta_scale<a class="anchor" aria-label="anchor" href="#arg-theta-scale"></a></dt>
<dd><p>optional list of 4 possible elements specifying a set of location effects (fixed or random) that are to be scaled by the parameter <code>theta_scale</code> for the subset of observations which have level <code>level</code> in factor <code>factor</code>: <code>factor</code>, <code>level</code>, <code>fixed</code> (position of fixed terms to be scaled) and <code>random</code> (position of random effect components).</p></dd>

  <dt id="arg-savews">saveWS<a class="anchor" aria-label="anchor" href="#arg-savews"></a></dt>
<dd><p>logical: save design matrix for scaled effects.</p></dd>

  <dt id="arg-aggregate">aggregate<a class="anchor" aria-label="anchor" href="#arg-aggregate"></a></dt>
<dd><p>character: names of long-format variables to be formed from wide-format variables in multi-trait models. Wide-format variables should have the long-format variable name followed by an underscore and then the trait name. For example, a wide-format data frame might have variable names <code>y1</code>, <code>y2</code>, <code>x_y1</code>, <code>x_y2</code>. If a multi-trait model is fitted for <code>y1</code> and <code>y2</code> then <code>aggregate="x"</code> generates the new variable <code>x=c(x_y1, x_y2)</code>.</p></dd>

  <dt id="arg-longer-positive-integer-that-multiples-nitt-thin-and-burnin">longer: positive integer that multiples <code>nitt</code>, <code>thin</code> and <code>burnin</code><a class="anchor" aria-label="anchor" href="#arg-longer-positive-integer-that-multiples-nitt-thin-and-burnin"></a></dt>
<dd><p></p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p></p>
<dl><dt>Sol</dt>
<dd><p>Posterior Distribution of MME solutions, including fixed effects</p></dd>

  <dt>VCV</dt>
<dd><p>Posterior Distribution of (co)variance matrices</p></dd>

  <dt>CP</dt>
<dd><p>Posterior Distribution of cut-points from an ordinal model</p></dd>

  <dt>Liab</dt>
<dd><p>Posterior Distribution of latent variables</p></dd>

  <dt>Fixed</dt>
<dd><p>list: fixed formula and number of fixed effects</p></dd>

  <dt>Random</dt>
<dd><p>list: random formula, dimensions of each covariance matrix, number of levels per covariance matrix, and term in random formula to which each covariance belongs</p></dd>

  <dt>Residual</dt>
<dd><p>list: residual formula, dimensions of each covariance matrix, number of levels per covariance matrix, and term in residual formula to which each covariance belongs</p></dd>

  <dt>Deviance</dt>
<dd><p>deviance -2*log(p(y|...))</p></dd>

  <dt>DIC</dt>
<dd><p>deviance information criterion</p></dd>

  <dt>X</dt>
<dd><p>sparse fixed effect design matrix</p></dd>

  <dt>Z</dt>
<dd><p>sparse random effect design matrix</p></dd>

  <dt>XL</dt>
<dd><p>sparse structural parameter design matrix</p></dd>

  <dt>error.term</dt>
<dd><p>residual term for each datum</p></dd>

  <dt>family</dt>
<dd><p>distribution of each datum</p></dd>

  <dt>Tune</dt>
<dd><p>(co)variance matrix of the proposal distribution for the latent variables</p></dd>

  <dt>meta</dt>
<dd><p>logical; was <code>mev</code> passed?</p></dd>

  <dt>Wscale</dt>
<dd><p>sparse design matrix for scaled terms.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>General analyses: Hadfield, J.D. (2010) Journal of Statistical Software 33 2 1-22</p>	
<p>Phylogenetic analyses: Hadfield, J.D. &amp; Nakagawa, S. (2010) Journal of Evolutionary Biology 23 494-508</p>	
<p>Background Sorensen, D. &amp; Gianola, D. (2002) Springer</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jarrod Hadfield <a href="mailto:j.hadfield@ed.ac.uk">j.hadfield@ed.ac.uk</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/coda/man/mcmc.html" class="external-link">mcmc</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 1: univariate Gaussian model with standard random effect</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">PlodiaPO</span><span class="op">)</span>  </span></span>
<span class="r-in"><span><span class="va">model1</span><span class="op">&lt;-</span><span class="fu">MCMCglmm</span><span class="op">(</span><span class="va">PO</span><span class="op">~</span><span class="fl">1</span>, random<span class="op">=</span><span class="op">~</span><span class="va">FSfamily</span>, data<span class="op">=</span><span class="va">PlodiaPO</span>, verbose<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span> nitt<span class="op">=</span><span class="fl">1300</span>, burnin<span class="op">=</span><span class="fl">300</span>, thin<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Iterations = 301:1300</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Thinning interval  = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Sample size  = 1000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  DIC: -239.78 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  G-structure:  ~FSfamily</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          post.mean l-95% CI u-95% CI eff.samp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FSfamily   0.01027 0.005385  0.01579    414.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  R-structure:  ~units</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       post.mean l-95% CI u-95% CI eff.samp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> units    0.0341  0.02966  0.03843    826.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Location effects: PO ~ 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             post.mean l-95% CI u-95% CI eff.samp  pMCMC    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)     1.163    1.132    1.195     1463 &lt;0.001 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: univariate Gaussian model with phylogenetically correlated</span></span></span>
<span class="r-in"><span><span class="co"># random effect</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bird.families</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">phylo.effect</span><span class="op">&lt;-</span><span class="fu"><a href="rbv.html">rbv</a></span><span class="op">(</span><span class="va">bird.families</span>, <span class="fl">1</span>, nodes<span class="op">=</span><span class="st">"TIPS"</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">phenotype</span><span class="op">&lt;-</span><span class="va">phylo.effect</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">phylo.effect</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>  </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simulate phylogenetic and residual effects with unit variance</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">test.data</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>phenotype<span class="op">=</span><span class="va">phenotype</span>, taxon<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">phenotype</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Ainv</span><span class="op">&lt;-</span><span class="fu"><a href="inverseA.html">inverseA</a></span><span class="op">(</span><span class="va">bird.families</span><span class="op">)</span><span class="op">$</span><span class="va">Ainv</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># inverse matrix of shared phyloegnetic history</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">prior</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>R<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>V<span class="op">=</span><span class="fl">1</span>, nu<span class="op">=</span><span class="fl">0.002</span><span class="op">)</span>, G<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>G1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>V<span class="op">=</span><span class="fl">1</span>, nu<span class="op">=</span><span class="fl">0.002</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model2</span><span class="op">&lt;-</span><span class="fu">MCMCglmm</span><span class="op">(</span><span class="va">phenotype</span><span class="op">~</span><span class="fl">1</span>, random<span class="op">=</span><span class="op">~</span><span class="va">taxon</span>, ginverse<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>taxon<span class="op">=</span><span class="va">Ainv</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> data<span class="op">=</span><span class="va">test.data</span>, prior<span class="op">=</span><span class="va">prior</span>, verbose<span class="op">=</span><span class="cn">FALSE</span>, nitt<span class="op">=</span><span class="fl">1300</span>, burnin<span class="op">=</span><span class="fl">300</span>, thin<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model2</span><span class="op">$</span><span class="va">VCV</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="MCMCglmm-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jarrod Hadfield.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

