<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plots covariance matrices — plotsubspace • MCMCglmm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plots covariance matrices — plotsubspace"><meta name="description" content="Represents covariance matrices as 3-d ellipsoids using the rgl package.
Covariance matrices of dimension greater than 3 are plotted on the subspace
defined by the first three eigenvectors."><meta property="og:description" content="Represents covariance matrices as 3-d ellipsoids using the rgl package.
Covariance matrices of dimension greater than 3 are plotted on the subspace
defined by the first three eigenvectors."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MCMCglmm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.36</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../course-notes/index.html">Course notes</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/jarrodhadfield/MCMCglmm"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plots covariance matrices</h1>

      <div class="d-none name"><code>plotsubspace.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Represents covariance matrices as 3-d ellipsoids using the <code>rgl</code> package.
Covariance matrices of dimension greater than 3 are plotted on the subspace
defined by the first three eigenvectors.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotsubspace</span><span class="op">(</span><span class="va">CA</span>, CB<span class="op">=</span><span class="cn">NULL</span>, corr <span class="op">=</span> <span class="cn">FALSE</span>, shadeCA <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>      shadeCB <span class="op">=</span> <span class="cn">TRUE</span>, axes.lab <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-ca">CA<a class="anchor" aria-label="anchor" href="#arg-ca"></a></dt>
<dd><p>Matrix</p></dd>

  <dt id="arg-cb">CB<a class="anchor" aria-label="anchor" href="#arg-cb"></a></dt>
<dd><p>Optional second matrix</p></dd>

  <dt id="arg-corr">corr<a class="anchor" aria-label="anchor" href="#arg-corr"></a></dt>
<dd><p>If <code>TRUE</code> the covariance matrices are transformed into
correlation matrices</p></dd>

  <dt id="arg-shadeca">shadeCA<a class="anchor" aria-label="anchor" href="#arg-shadeca"></a></dt>
<dd><p>If <code>TRUE</code> the ellipsoid is solid, if <code>FALSE</code> the
ellipsoid is wireframe</p></dd>

  <dt id="arg-shadecb">shadeCB<a class="anchor" aria-label="anchor" href="#arg-shadecb"></a></dt>
<dd><p>If <code>TRUE</code> the ellipsoid is solid, if <code>FALSE</code> the
ellipsoid is wireframe</p></dd>

  <dt id="arg-axes-lab">axes.lab<a class="anchor" aria-label="anchor" href="#arg-axes-lab"></a></dt>
<dd><p>If <code>TRUE</code> the axes are labelled with the eigenvectors</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further arguments to be passed</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The matrix CA is always red, and the matrix CB if given is always blue. The
subspace is defined by the first three eigenvectors of CA, and the percentage of
variance for each matrix along these three dimensions is given in the plot
title.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jarrod Hadfield <a href="mailto:j.hadfield@ed.ac.uk">j.hadfield@ed.ac.uk</a> with code taken from the <code>rgl</code> package</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://dmurdoch.github.io/rgl/dev/reference/rgl-package.html" class="external-link">rgl</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span> <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"rgl"</span><span class="op">)</span><span class="op">!=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="va">G1</span><span class="op">&lt;-</span><span class="fu"><a href="rIW.html">rIW</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>,<span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="va">G2</span><span class="op">&lt;-</span><span class="va">G1</span><span class="op">*</span><span class="fl">1.2</span></span></span>
<span class="r-in"><span> <span class="co">#  plotsubspace(G1, G2, shadeCB=FALSE)</span></span></span>
<span class="r-in"><span> <span class="co"># commented out because of problems with rgl </span></span></span>
<span class="r-in"><span> <span class="op">}</span> </span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required namespace: rgl</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>RGL: unable to open X11 display</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'rgl.init' failed, will use the null device.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> See '?rgl.useNULL' for ways to avoid this warning.</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jarrod Hadfield.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

