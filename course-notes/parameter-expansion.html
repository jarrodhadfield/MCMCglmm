<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Parameter Expansion | MCMCglmm Course Notes</title>
  <meta name="description" content="Extended documentation and course notes for the MCMCglmm R package." />
  <meta name="generator" content="bookdown 0.46 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Parameter Expansion | MCMCglmm Course Notes" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Extended documentation and course notes for the MCMCglmm R package." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Parameter Expansion | MCMCglmm Course Notes" />
  
  <meta name="twitter:description" content="Extended documentation and course notes for the MCMCglmm R package." />
  

<meta name="author" content="Jarrod Hadfield" />


<meta name="date" content="2026-01-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="pedigree.html"/>
<link rel="next" href="path.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/rglWebGL-binding-1.3.31/rglWebGL.js"></script>
<link href="libs/rglwidgetClass-1.3.31/rgl.css" rel="stylesheet" />
<script src="libs/rglwidgetClass-1.3.31/rglClass.src.js"></script>
<script src="libs/rglwidgetClass-1.3.31/utils.src.js"></script>
<script src="libs/rglwidgetClass-1.3.31/buffer.src.js"></script>
<script src="libs/rglwidgetClass-1.3.31/subscenes.src.js"></script>
<script src="libs/rglwidgetClass-1.3.31/shaders.src.js"></script>
<script src="libs/rglwidgetClass-1.3.31/shadersrc.src.js"></script>
<script src="libs/rglwidgetClass-1.3.31/textures.src.js"></script>
<script src="libs/rglwidgetClass-1.3.31/projection.src.js"></script>
<script src="libs/rglwidgetClass-1.3.31/mouse.src.js"></script>
<script src="libs/rglwidgetClass-1.3.31/init.src.js"></script>
<script src="libs/rglwidgetClass-1.3.31/pieces.src.js"></script>
<script src="libs/rglwidgetClass-1.3.31/draw.src.js"></script>
<script src="libs/rglwidgetClass-1.3.31/controls.src.js"></script>
<script src="libs/rglwidgetClass-1.3.31/selection.src.js"></script>
<script src="libs/rglwidgetClass-1.3.31/rglTimer.src.js"></script>
<script src="libs/rglwidgetClass-1.3.31/pretty.src.js"></script>
<script src="libs/rglwidgetClass-1.3.31/axes.src.js"></script>
<script src="libs/rglwidgetClass-1.3.31/animation.src.js"></script>
<script src="libs/CanvasMatrix4-1.3.31/CanvasMatrix.src.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i><b>1</b> Overview</a>
<ul>
<li class="chapter" data-level="1.1" data-path="overview.html"><a href="overview.html#outline"><i class="fa fa-check"></i><b>1.1</b> Outline</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="bayesian.html"><a href="bayesian.html"><i class="fa fa-check"></i><b>2</b> Bayesian Analysis and MCMC</a>
<ul>
<li class="chapter" data-level="2.1" data-path="bayesian.html"><a href="bayesian.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="bayesian.html"><a href="bayesian.html#likelihood"><i class="fa fa-check"></i><b>2.2</b> Likelihood</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="bayesian.html"><a href="bayesian.html#maximum-likelihood-ml"><i class="fa fa-check"></i><b>2.2.1</b> Maximum Likelihood (ML)</a></li>
<li class="chapter" data-level="2.2.2" data-path="bayesian.html"><a href="bayesian.html#restricted-maximum-likelihood-reml"><i class="fa fa-check"></i><b>2.2.2</b> Restricted Maximum Likelihood (REML)</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="bayesian.html"><a href="bayesian.html#prior-distribution"><i class="fa fa-check"></i><b>2.3</b> Prior Distribution</a></li>
<li class="chapter" data-level="2.4" data-path="bayesian.html"><a href="bayesian.html#posterior-distribution"><i class="fa fa-check"></i><b>2.4</b> Posterior Distribution</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="bayesian.html"><a href="bayesian.html#marginal-posterior-distribution"><i class="fa fa-check"></i><b>2.4.1</b> Marginal Posterior Distribution</a></li>
<li class="chapter" data-level="2.4.2" data-path="bayesian.html"><a href="bayesian.html#intervals-sec"><i class="fa fa-check"></i><b>2.4.2</b> Credible Intervals</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="bayesian.html"><a href="bayesian.html#MCMC"><i class="fa fa-check"></i><b>2.5</b> MCMC</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="bayesian.html"><a href="bayesian.html#starting-values"><i class="fa fa-check"></i><b>2.5.1</b> Starting values</a></li>
<li class="chapter" data-level="2.5.2" data-path="bayesian.html"><a href="bayesian.html#metropolis-hastings-updates"><i class="fa fa-check"></i><b>2.5.2</b> Metropolis-Hastings updates</a></li>
<li class="chapter" data-level="2.5.3" data-path="bayesian.html"><a href="bayesian.html#gibbs-sampling"><i class="fa fa-check"></i><b>2.5.3</b> Gibbs Sampling</a></li>
<li class="chapter" data-level="2.5.4" data-path="bayesian.html"><a href="bayesian.html#diagnostics-sec"><i class="fa fa-check"></i><b>2.5.4</b> MCMC Diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="bayesian.html"><a href="bayesian.html#Vprior-sec"><i class="fa fa-check"></i><b>2.6</b> Priors for Residual Variances</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="bayesian.html"><a href="bayesian.html#IP-sec"><i class="fa fa-check"></i><b>2.6.1</b> Improper Priors</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="bayesian.html"><a href="bayesian.html#transform-sec"><i class="fa fa-check"></i><b>2.7</b> Transformations</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>3</b> Linear and Generalised Linear Models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="glm.html"><a href="glm.html#linear-model-lm"><i class="fa fa-check"></i><b>3.1</b> Linear Model (LM)</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="glm.html"><a href="glm.html#lm-sec"><i class="fa fa-check"></i><b>3.1.1</b> Linear Predictors</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="glm.html"><a href="glm.html#generalised-linear-model-glm"><i class="fa fa-check"></i><b>3.2</b> Generalised Linear Model (GLM)</a></li>
<li class="chapter" data-level="3.3" data-path="glm.html"><a href="glm.html#poisson-glm"><i class="fa fa-check"></i><b>3.3</b> Poisson GLM</a></li>
<li class="chapter" data-level="3.4" data-path="glm.html"><a href="glm.html#overdispersion"><i class="fa fa-check"></i><b>3.4</b> Overdispersion</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="glm.html"><a href="glm.html#multiplicative-overdispersion"><i class="fa fa-check"></i><b>3.4.1</b> Multiplicative Overdispersion</a></li>
<li class="chapter" data-level="3.4.2" data-path="glm.html"><a href="glm.html#addod-sec"><i class="fa fa-check"></i><b>3.4.2</b> Additive Overdispersion</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="glm.html"><a href="glm.html#prediction-in-glm"><i class="fa fa-check"></i><b>3.5</b> Prediction in GLM</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="glm.html"><a href="glm.html#posterior-predictive-distribution"><i class="fa fa-check"></i><b>3.5.1</b> Posterior Predictive Distribution</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="glm.html"><a href="glm.html#binom-sec"><i class="fa fa-check"></i><b>3.6</b> Binomial and Bernoulli GLM</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="glm.html"><a href="glm.html#overdispersion-1"><i class="fa fa-check"></i><b>3.6.1</b> Overdispersion</a></li>
<li class="chapter" data-level="3.6.2" data-path="glm.html"><a href="glm.html#prediction"><i class="fa fa-check"></i><b>3.6.2</b> Prediction</a></li>
<li class="chapter" data-level="3.6.3" data-path="glm.html"><a href="glm.html#bernoulli-sec"><i class="fa fa-check"></i><b>3.6.3</b> Bernoulli GLM</a></li>
<li class="chapter" data-level="3.6.4" data-path="glm.html"><a href="glm.html#probit-link"><i class="fa fa-check"></i><b>3.6.4</b> Probit link</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="glm.html"><a href="glm.html#ordinal-data"><i class="fa fa-check"></i><b>3.7</b> Ordinal Data</a></li>
<li class="chapter" data-level="3.8" data-path="glm.html"><a href="glm.html#non-zero-binomial-data"><i class="fa fa-check"></i><b>3.8</b> Non-zero Binomial Data</a></li>
<li class="chapter" data-level="3.9" data-path="glm.html"><a href="glm.html#complete-separation"><i class="fa fa-check"></i><b>3.9</b> Complete Separation</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="glm.html"><a href="glm.html#gelman-prior-sec"><i class="fa fa-check"></i><b>3.9.1</b> The <span class="citation">Gelman, Jakulin, et al. (2008)</span> prior</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ranef.html"><a href="ranef.html"><i class="fa fa-check"></i><b>4</b> Random effects</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ranef.html"><a href="ranef.html#GLMM"><i class="fa fa-check"></i><b>4.1</b> Generalised Linear Mixed Model (GLMM)</a></li>
<li class="chapter" data-level="4.2" data-path="ranef.html"><a href="ranef.html#ranpred-sec"><i class="fa fa-check"></i><b>4.2</b> Prediction with Random Effects</a></li>
<li class="chapter" data-level="4.3" data-path="ranef.html"><a href="ranef.html#overdispersed-binomial-as-a-bernoulli-glmm"><i class="fa fa-check"></i><b>4.3</b> Overdispersed Binomial as a Bernoulli GLMM</a></li>
<li class="chapter" data-level="4.4" data-path="ranef.html"><a href="ranef.html#intra-class-correlations"><i class="fa fa-check"></i><b>4.4</b> Intra-class Correlations</a></li>
<li class="chapter" data-level="4.5" data-path="ranef.html"><a href="ranef.html#PXprior-sec"><i class="fa fa-check"></i><b>4.5</b> Priors for Random Effect Variances</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="ranef.html"><a href="ranef.html#f-and-folded-t-priors"><i class="fa fa-check"></i><b>4.5.1</b> <span class="math inline">\(F\)</span> and folded-<span class="math inline">\(t\)</span> priors</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="ranef.html"><a href="ranef.html#fix-or-rand"><i class="fa fa-check"></i><b>4.6</b> Fixed or Random?</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="cat-int.html"><a href="cat-int.html"><i class="fa fa-check"></i><b>5</b> Categorical Random Interactions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="cat-int.html"><a href="cat-int.html#idh-variance-structure"><i class="fa fa-check"></i><b>5.1</b> <code>idh</code> Variance Structure</a></li>
<li class="chapter" data-level="5.2" data-path="cat-int.html"><a href="cat-int.html#us-variance-structure"><i class="fa fa-check"></i><b>5.2</b> <code>us</code> Variance Structure</a></li>
<li class="chapter" data-level="5.3" data-path="cat-int.html"><a href="cat-int.html#compound-variance-structures"><i class="fa fa-check"></i><b>5.3</b> Compound Variance Structures</a></li>
<li class="chapter" data-level="5.4" data-path="cat-int.html"><a href="cat-int.html#heter-sec"><i class="fa fa-check"></i><b>5.4</b> Heterogenous Residual Variance</a></li>
<li class="chapter" data-level="5.5" data-path="cat-int.html"><a href="cat-int.html#contrasts-and-covariances"><i class="fa fa-check"></i><b>5.5</b> Contrasts and Covariances</a></li>
<li class="chapter" data-level="5.6" data-path="cat-int.html"><a href="cat-int.html#VCVprior-sec"><i class="fa fa-check"></i><b>5.6</b> Priors for Covariance Matrices</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="cat-int.html"><a href="cat-int.html#priors-for-us-structures"><i class="fa fa-check"></i><b>5.6.1</b> Priors for <code>us</code> structures</a></li>
<li class="chapter" data-level="5.6.2" data-path="cat-int.html"><a href="cat-int.html#priors-for-idh-structures"><i class="fa fa-check"></i><b>5.6.2</b> Priors for <code>idh</code> structures</a></li>
<li class="chapter" data-level="5.6.3" data-path="cat-int.html"><a href="cat-int.html#priors-for-corg-and-corgh-structures"><i class="fa fa-check"></i><b>5.6.3</b> Priors for <code>corg</code> and <code>corgh</code> structures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="cont-int.html"><a href="cont-int.html"><i class="fa fa-check"></i><b>6</b> Continuous Random Interactions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="cont-int.html"><a href="cont-int.html#random-regression"><i class="fa fa-check"></i><b>6.1</b> Random Regression</a></li>
<li class="chapter" data-level="6.2" data-path="cont-int.html"><a href="cont-int.html#expected-variances-and-covariances"><i class="fa fa-check"></i><b>6.2</b> Expected Variances and Covariances</a></li>
<li class="chapter" data-level="6.3" data-path="cont-int.html"><a href="cont-int.html#RRcentering"><i class="fa fa-check"></i><b>6.3</b> <code>us</code> versus <code>idh</code> and mean centering</a></li>
<li class="chapter" data-level="6.4" data-path="cont-int.html"><a href="cont-int.html#meta-sec"><i class="fa fa-check"></i><b>6.4</b> Meta-analysis</a></li>
<li class="chapter" data-level="6.5" data-path="cont-int.html"><a href="cont-int.html#splines"><i class="fa fa-check"></i><b>6.5</b> Splines</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="multi.html"><a href="multi.html"><i class="fa fa-check"></i><b>7</b> Multi-response models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="multi.html"><a href="multi.html#relaxing-the-univariate-assumptions-of-causality"><i class="fa fa-check"></i><b>7.1</b> Relaxing the univariate assumptions of causality</a></li>
<li class="chapter" data-level="7.2" data-path="multi.html"><a href="multi.html#multinomial-models"><i class="fa fa-check"></i><b>7.2</b> Multinomial Models</a></li>
<li class="chapter" data-level="7.3" data-path="multi.html"><a href="multi.html#zero-inflated-models"><i class="fa fa-check"></i><b>7.3</b> Zero-inflated Models</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="multi.html"><a href="multi.html#posterior-predictive-checks"><i class="fa fa-check"></i><b>7.3.1</b> Posterior predictive checks</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="multi.html"><a href="multi.html#Hurdle"><i class="fa fa-check"></i><b>7.4</b> Hurdle Models</a></li>
<li class="chapter" data-level="7.5" data-path="multi.html"><a href="multi.html#ZAP"><i class="fa fa-check"></i><b>7.5</b> Zero-altered Models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="pedigree.html"><a href="pedigree.html"><i class="fa fa-check"></i><b>8</b> Pedigrees and Phylogenies</a>
<ul>
<li class="chapter" data-level="8.1" data-path="pedigree.html"><a href="pedigree.html#pedigree-and-phylogeny-formats"><i class="fa fa-check"></i><b>8.1</b> Pedigree and phylogeny formats</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="pedigree.html"><a href="pedigree.html#pedigrees"><i class="fa fa-check"></i><b>8.1.1</b> Pedigrees</a></li>
<li class="chapter" data-level="8.1.2" data-path="pedigree.html"><a href="pedigree.html#phylogenies"><i class="fa fa-check"></i><b>8.1.2</b> Phylogenies</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="pedigree.html"><a href="pedigree.html#the-animal-model-and-the-phylogenetic-mixed-model"><i class="fa fa-check"></i><b>8.2</b> The animal model and the phylogenetic mixed model</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="parameter-expansion.html"><a href="parameter-expansion.html"><i class="fa fa-check"></i><b>9</b> Parameter Expansion</a>
<ul>
<li class="chapter" data-level="9.0.1" data-path="parameter-expansion.html"><a href="parameter-expansion.html#variances-close-to-zero"><i class="fa fa-check"></i><b>9.0.1</b> Variances close to zero</a></li>
<li class="chapter" data-level="9.0.2" data-path="parameter-expansion.html"><a href="parameter-expansion.html#secPX-p"><i class="fa fa-check"></i><b>9.0.2</b> Parameter expanded priors</a></li>
<li class="chapter" data-level="9.0.3" data-path="parameter-expansion.html"><a href="parameter-expansion.html#binary-response-models"><i class="fa fa-check"></i><b>9.0.3</b> Binary response models</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="path.html"><a href="path.html"><i class="fa fa-check"></i><b>10</b> Path Analysis &amp; Antedependence Structures</a>
<ul>
<li class="chapter" data-level="10.1" data-path="path.html"><a href="path.html#path-anlaysis"><i class="fa fa-check"></i><b>10.1</b> Path Anlaysis</a></li>
<li class="chapter" data-level="10.2" data-path="path.html"><a href="path.html#ante-sec"><i class="fa fa-check"></i><b>10.2</b> Antedependence</a></li>
<li class="chapter" data-level="10.3" data-path="path.html"><a href="path.html#scaling"><i class="fa fa-check"></i><b>10.3</b> Scaling</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="technical-details.html"><a href="technical-details.html"><i class="fa fa-check"></i><b>11</b> Technical Details</a>
<ul>
<li class="chapter" data-level="11.1" data-path="technical-details.html"><a href="technical-details.html#model-form"><i class="fa fa-check"></i><b>11.1</b> Model Form</a></li>
<li class="chapter" data-level="11.2" data-path="technical-details.html"><a href="technical-details.html#MCMC-app"><i class="fa fa-check"></i><b>11.2</b> MCMC Sampling Schemes</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="technical-details.html"><a href="technical-details.html#updating-the-latent-variables-bf-l"><i class="fa fa-check"></i><b>11.2.1</b> Updating the latent variables <span class="math inline">\({\bf l}\)</span></a></li>
<li class="chapter" data-level="11.2.2" data-path="technical-details.html"><a href="technical-details.html#updating-the-location-vector-boldsymboltheta-leftboldsymbolmathbfbeta-bf-uright"><i class="fa fa-check"></i><b>11.2.2</b> Updating the location vector <span class="math inline">\(\boldsymbol{\theta} = \left[{\boldsymbol{\mathbf{\beta}}}^{&#39;}\; {\bf u}^{&#39;}\right]^{&#39;}\)</span></a></li>
<li class="chapter" data-level="11.2.3" data-path="technical-details.html"><a href="technical-details.html#updating-the-variance-structures-bf-g-and-bf-r"><i class="fa fa-check"></i><b>11.2.3</b> Updating the variance structures <span class="math inline">\({\bf G}\)</span> and <span class="math inline">\({\bf R}\)</span></a></li>
<li class="chapter" data-level="11.2.4" data-path="technical-details.html"><a href="technical-details.html#ordinal-models"><i class="fa fa-check"></i><b>11.2.4</b> Ordinal Models</a></li>
<li class="chapter" data-level="11.2.5" data-path="technical-details.html"><a href="technical-details.html#path-analyses"><i class="fa fa-check"></i><b>11.2.5</b> Path Analyses</a></li>
<li class="chapter" data-level="11.2.6" data-path="technical-details.html"><a href="technical-details.html#deviance-and-dic"><i class="fa fa-check"></i><b>11.2.6</b> Deviance and DIC</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>12</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MCMCglmm Course Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="parameter-expansion" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">9</span> Parameter Expansion<a href="parameter-expansion.html#parameter-expansion" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>As the covariance matrix approaches a singularity the mixing of the chain becomes notoriously slow. This problem is often encountered in single-response models when a variance component is small and the chain becomes stuck at values close to zero. Similar problems occur for the EM algorithm and <span class="citation">C. H. Liu, Rubin, and Wu (<a href="#ref-Liu.1998">1998</a>)</span> introduced parameter expansion to speed up the rate of convergence. The idea was quickly applied to Gibbs sampling problems <span class="citation">(<a href="#ref-Liu.1999">J. S. Liu and Wu 1999</a>)</span> and has now been extensively used to develop more efficient mixed-model samplers <span class="citation">(e.g. <a href="#ref-vanDyk.2001">Dyk and Meng 2001</a>; <a href="#ref-Gelman.2008b">Gelman, Dyk, et al. 2008</a>; <a href="#ref-Browne.2009">Browne et al. 2009</a>)</span>.</p>
<p>The columns of the design matrix (<span class="math inline">\({\bf W}\)</span>) can be multiplied by the non-identified working parameters <span class="math inline">\({\boldsymbol{\mathbf{\alpha}}} = \left[1,\ \alpha_{1},\ \alpha_{2},\ \dots \alpha_{k}\right]^{&#39;}\)</span>:</p>
<p><span class="math display" id="eq:wstar">\[{\bf W}_{\alpha} = \left[{\bf X}\ {\bf Z}_{1}\alpha_{1}\ {\bf Z}_{2}\alpha_{2}\ \dots\ {\bf Z}_{k}\alpha_{k}\right]
\label{wstar}   \tag{9.1}\]</span></p>
<p>where the indices denote submatrices of <span class="math inline">\({\bf Z}\)</span> which pertain to effects associated with the same variance component. Replacing <span class="math inline">\({\bf W}\)</span> with <span class="math inline">\({\bf W}_{\alpha}\)</span> we can sample the new location effects <span class="math inline">\(\boldsymbol{\theta}_{\alpha}\)</span> as described above, and rescale them to obtain <span class="math inline">\(\boldsymbol{\theta}\)</span>:</p>
<p><span class="math display">\[\boldsymbol{\theta} = ({\bf I}_{\beta}\oplus_{i=1}^{k}{\bf I}_{u_{i}}\ \alpha_{i})\boldsymbol{\theta}_{\alpha}\]</span></p>
<p>where the identity matrices are of dimension equal to the length of the subscripted parameter vectors.</p>
<p>Likewise, the (co)variance matrices can be rescaled by the set of <span class="math inline">\(\alpha\)</span>’s associated with the variances of a particular variance structure component (<span class="math inline">\({\boldsymbol{\mathbf{\alpha}}}_{\mathcal{V}}\)</span>):</p>
<p><span class="math display">\[{\bf V} = Diag({\boldsymbol{\mathbf{\alpha}}}_{\mathcal{V}}){\bf V}_{\alpha}Diag({\boldsymbol{\mathbf{\alpha}}}_{\mathcal{V}})\]</span></p>
<p>The working parameters are not identifiable in the likelihood, but do have a proper conditional distribution. Defining the <span class="math inline">\(n\times(k+1)\)</span> design matrix <span class="math inline">\({\bf X}_{\alpha}\)</span> with each column equal to the submatrices in Equation <a href="parameter-expansion.html#eq:wstar">(9.1)</a> postmultiplied by the relevant subvectors of <span class="math inline">\(\boldsymbol{\theta}_{\alpha}\)</span>, we can see that <span class="math inline">\({\boldsymbol{\mathbf{\alpha}}}\)</span> is a vector of regression coefficients:</p>
<p><span class="math display">\[\begin{array}{rl}
\bf{l} =&amp; {\bf X}_{\alpha}{\boldsymbol{\mathbf{\alpha}}}+\bf{e}\\
\end{array}\]</span></p>
<p>and so the methods described above can be used to update them.</p>
<div id="variances-close-to-zero" class="section level3 hasAnchor" number="9.0.1">
<h3><span class="header-section-number">9.0.1</span> Variances close to zero<a href="parameter-expansion.html#variances-close-to-zero" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To use parameter exapnsion in <span class="math inline">\(\texttt{MCMCglmm}\)</span> it is necessary to specify a prior covariance matrix for <span class="math inline">\({\boldsymbol{\mathbf{\alpha}}}\)</span> which is non-null. In section I discuss what this prior means in the context of posterior inference but for now we will specify two models, one parameter expanded and the other not. To illustrate I will fit a model that estimates the between mother variation in offsping sex ratio using parameter expansions:</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="parameter-expansion.html#cb289-1" tabindex="-1"></a><span class="fu">data</span>(BTdata)</span>
<span id="cb289-2"><a href="parameter-expansion.html#cb289-2" tabindex="-1"></a>BTdata<span class="sc">$</span>sex[<span class="fu">which</span>(BTdata<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">&quot;UNK&quot;</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb289-3"><a href="parameter-expansion.html#cb289-3" tabindex="-1"></a>BTdata<span class="sc">$</span>sex <span class="ot">&lt;-</span> gdata<span class="sc">::</span><span class="fu">drop.levels</span>(BTdata<span class="sc">$</span>sex)  <span class="co"># treat unknowns as missing data</span></span>
<span id="cb289-4"><a href="parameter-expansion.html#cb289-4" tabindex="-1"></a></span>
<span id="cb289-5"><a href="parameter-expansion.html#cb289-5" tabindex="-1"></a>prior1b <span class="ot">=</span> <span class="fu">list</span>(<span class="at">R =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="dv">1</span>, <span class="at">fix =</span> <span class="dv">1</span>), <span class="at">G =</span> <span class="fu">list</span>(<span class="at">G1 =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="dv">1</span>, <span class="at">nu =</span> <span class="dv">1</span>, <span class="at">alpha.mu =</span> <span class="dv">0</span>,</span>
<span id="cb289-6"><a href="parameter-expansion.html#cb289-6" tabindex="-1"></a>    <span class="at">alpha.V =</span> <span class="dv">1000</span>)))</span>
<span id="cb289-7"><a href="parameter-expansion.html#cb289-7" tabindex="-1"></a>m7b<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">MCMCglmm</span>(sex <span class="sc">~</span> <span class="dv">1</span>, <span class="at">random =</span> <span class="sc">~</span>dam, <span class="at">data =</span> BTdata, <span class="at">family =</span> <span class="st">&quot;categorical&quot;</span>,</span>
<span id="cb289-8"><a href="parameter-expansion.html#cb289-8" tabindex="-1"></a>    <span class="at">prior =</span> prior1b)</span></code></pre></div>
<p>and fit a model that does not use parameter expansion:</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="parameter-expansion.html#cb290-1" tabindex="-1"></a>prior2b <span class="ot">=</span> <span class="fu">list</span>(<span class="at">R =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="dv">1</span>, <span class="at">fix =</span> <span class="dv">1</span>), <span class="at">G =</span> <span class="fu">list</span>(<span class="at">G1 =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="fl">1e-10</span>, <span class="at">nu =</span> <span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb290-2"><a href="parameter-expansion.html#cb290-2" tabindex="-1"></a>m7b<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">MCMCglmm</span>(sex <span class="sc">~</span> <span class="dv">1</span>, <span class="at">random =</span> <span class="sc">~</span>dam, <span class="at">data =</span> BTdata, <span class="at">family =</span> <span class="st">&quot;categorical&quot;</span>,</span>
<span id="cb290-3"><a href="parameter-expansion.html#cb290-3" tabindex="-1"></a>    <span class="at">prior =</span> prior2b)</span></code></pre></div>
<p>The prior densities in the two models are very similar across the range of variances with reasonable posterior support, and running the models for long enough will verify that they are sampling from very similar posterior densities. However, the mixing properties of the two chains are very different, with the non-parameter expanded chain (in red) getting stuck at values close to zero more often (Figure <a href="parameter-expansion.html#fig:sexratio">9.1</a>).</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="parameter-expansion.html#cb291-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">mcmc.list</span>(m7b<span class="fl">.1</span><span class="sc">$</span>VCV[, <span class="dv">1</span>], m7b<span class="fl">.2</span><span class="sc">$</span>VCV[, <span class="dv">1</span>]))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:sexratio"></span>
<img src="_bookdown_files/fig/sexratio-1.png" alt="Traces of the sampled posterior distribution for between female variance in sex ratio. The black trace is from a parameter expanded model, and the red trace from a non-parameter expanded model." width="672" />
<p class="caption">
Figure 9.1: Traces of the sampled posterior distribution for between female variance in sex ratio. The black trace is from a parameter expanded model, and the red trace from a non-parameter expanded model.
</p>
</div>
<p>The parameter expanded model is 25% slower per iteration but the effective sample size is 1.558 times greater:</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="parameter-expansion.html#cb292-1" tabindex="-1"></a><span class="fu">effectiveSize</span>(m7b<span class="fl">.1</span><span class="sc">$</span>VCV[, <span class="dv">1</span>])</span></code></pre></div>
<pre><code>##     var1 
## 146.3417</code></pre>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="parameter-expansion.html#cb294-1" tabindex="-1"></a><span class="fu">effectiveSize</span>(m7b<span class="fl">.2</span><span class="sc">$</span>VCV[, <span class="dv">1</span>])</span></code></pre></div>
<pre><code>##     var1 
## 93.90475</code></pre>
</div>
<div id="secPX-p" class="section level3 hasAnchor" number="9.0.2">
<h3><span class="header-section-number">9.0.2</span> Parameter expanded priors<a href="parameter-expansion.html#secPX-p" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The original aim of applying parameter expanded methods to Gibbs sampling was to speed up the convergence and mixing properties of the chain. They achieve this by introducing parameters that are not identified in the likelihood, and for which all information comes from the prior distribution. By placing priors on these parameters we can induce different prior distributions for the variance components. These priors are all from the non-central scaled F-distribution, which implies the prior for the standard deviation is a non-central folded scaled t-distribution <span class="citation">(<a href="#ref-Gelman.2006">Gelman 2006</a>)</span>. To use parameter expansion it is necessary to specify the prior means (<code>alpha.mu</code>) and prior covariance matrix (<code>alpha.V</code>) in the prior. Without loss of generality <code>V</code> can be set to one, so that the prior for the variance (<code>v</code>) has density function:</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="parameter-expansion.html#cb296-1" tabindex="-1"></a><span class="fu">df</span>(v<span class="sc">/</span>alpha.V, <span class="at">df1 =</span> <span class="dv">1</span>, <span class="at">df2 =</span> nu, <span class="at">ncp =</span> (alpha.mu<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>alpha.V)</span></code></pre></div>
<p>and the prior for the standard deviation:</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="parameter-expansion.html#cb297-1" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">dt</span>(<span class="fu">sqrt</span>(v)<span class="sc">/</span><span class="fu">sqrt</span>(alpha.V), <span class="at">df =</span> nu, <span class="at">ncp =</span> alpha.mu<span class="sc">/</span><span class="fu">sqrt</span>(alpha.V))</span></code></pre></div>
<p>where <code>v</code><span class="math inline">\(&gt;0\)</span>.</p>
<p>To illustrate I’ll use the original Schools example from <span class="citation">(<a href="#ref-Gelman.2006">Gelman 2006</a>)</span></p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="parameter-expansion.html#cb298-1" tabindex="-1"></a>schools <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">school =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>], <span class="at">estimate =</span> <span class="fu">c</span>(<span class="fl">28.39</span>, <span class="fl">7.94</span>, <span class="sc">-</span><span class="fl">2.75</span>, <span class="fl">6.82</span>,</span>
<span id="cb298-2"><a href="parameter-expansion.html#cb298-2" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">0.64</span>, <span class="fl">0.63</span>, <span class="fl">18.01</span>, <span class="fl">12.16</span>), <span class="at">sd =</span> <span class="fu">c</span>(<span class="fl">14.9</span>, <span class="fl">10.2</span>, <span class="fl">16.3</span>, <span class="dv">11</span>, <span class="fl">9.4</span>, <span class="fl">11.4</span>, <span class="fl">10.4</span>, <span class="fl">17.6</span>))</span>
<span id="cb298-3"><a href="parameter-expansion.html#cb298-3" tabindex="-1"></a><span class="fu">head</span>(schools)</span></code></pre></div>
<pre><code>##   school estimate   sd
## 1      a    28.39 14.9
## 2      b     7.94 10.2
## 3      c    -2.75 16.3
## 4      d     6.82 11.0
## 5      e    -0.64  9.4
## 6      f     0.63 11.4</code></pre>
<p>The response variable <code>estimate</code> is the relative effect of Scholastic Aptitude Test coaching programs in 8 <code>schools</code>, and <code>sd</code> are the standard errors of the estimate. In the original example Gelman focused on the standard deviation of the between school effects and so we will place an improper flat prior on the standard deviation:</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="parameter-expansion.html#cb300-1" tabindex="-1"></a>prior1 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">R =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="fu">diag</span>(schools<span class="sc">$</span>sd<span class="sc">^</span><span class="dv">2</span>), <span class="at">fix =</span> <span class="dv">1</span>), <span class="at">G =</span> <span class="fu">list</span>(<span class="at">G1 =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="fl">1e-10</span>,</span>
<span id="cb300-2"><a href="parameter-expansion.html#cb300-2" tabindex="-1"></a>    <span class="at">nu =</span> <span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb300-3"><a href="parameter-expansion.html#cb300-3" tabindex="-1"></a>m7a<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">MCMCglmm</span>(estimate <span class="sc">~</span> <span class="dv">1</span>, <span class="at">random =</span> <span class="sc">~</span>school, <span class="at">rcov =</span> <span class="sc">~</span><span class="fu">idh</span>(school)<span class="sc">:</span>units, <span class="at">data =</span> schools,</span>
<span id="cb300-4"><a href="parameter-expansion.html#cb300-4" tabindex="-1"></a>    <span class="at">prior =</span> prior1)</span></code></pre></div>
<p>In this example there is information on the between school variance although we only have a single estimate for each school. This is possible because the within school variance was available for each school and we were able to fix the residual variance for each school at this value (See Section <a href="cont-int.html#meta-sec">6.4</a>). The posterior distribution of the between school standard deviation is shown in Figure <a href="parameter-expansion.html#fig:school1">9.2</a> with the flat prior shown as a solid line.</p>
<div class="figure"><span style="display:block;" id="fig:school1"></span>
<img src="_bookdown_files/fig/school1-1.png" alt="Between school standard deviation in educational test scores, with an improper uniform prior" width="672" />
<p class="caption">
Figure 9.2: Between school standard deviation in educational test scores, with an improper uniform prior
</p>
</div>
<p>We can also use the inverse-gamma prior with scale and shape equal to 0.001:</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="parameter-expansion.html#cb301-1" tabindex="-1"></a>prior2 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">R =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="fu">diag</span>(schools<span class="sc">$</span>sd<span class="sc">^</span><span class="dv">2</span>), <span class="at">fix =</span> <span class="dv">1</span>), <span class="at">G =</span> <span class="fu">list</span>(<span class="at">G1 =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="dv">1</span>,</span>
<span id="cb301-2"><a href="parameter-expansion.html#cb301-2" tabindex="-1"></a>    <span class="at">nu =</span> <span class="fl">0.002</span>)))</span>
<span id="cb301-3"><a href="parameter-expansion.html#cb301-3" tabindex="-1"></a>m7a<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">MCMCglmm</span>(estimate <span class="sc">~</span> <span class="dv">1</span>, <span class="at">random =</span> <span class="sc">~</span>school, <span class="at">rcov =</span> <span class="sc">~</span><span class="fu">idh</span>(school)<span class="sc">:</span>units, <span class="at">data =</span> schools,</span>
<span id="cb301-4"><a href="parameter-expansion.html#cb301-4" tabindex="-1"></a>    <span class="at">prior =</span> prior2)</span></code></pre></div>
<p>but Figure <a href="parameter-expansion.html#fig:school2">9.3</a> indicates that such a prior in this context may put too much density and values close to zero.</p>
<div class="figure"><span style="display:block;" id="fig:school2"></span>
<img src="_bookdown_files/fig/school2-1.png" alt="Between school standard deviation in educational test scores, with an inverse-gamma prior with shape and scale set to 0.001" width="672" />
<p class="caption">
Figure 9.3: Between school standard deviation in educational test scores, with an inverse-gamma prior with shape and scale set to 0.001
</p>
</div>
<p>For the final prior we have <code>V=1</code>, <code>nu=1</code>, <code>alpha.mu=0</code> which is equivalent to a proper Cauchy prior for the standard deviation with scale equal to <code>sqrt(alpha.V)</code>. Following <code>Gelman.2006</code> we use a scale of 25:</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="parameter-expansion.html#cb302-1" tabindex="-1"></a>prior3 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">R =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="fu">diag</span>(schools<span class="sc">$</span>sd<span class="sc">^</span><span class="dv">2</span>), <span class="at">fix =</span> <span class="dv">1</span>), <span class="at">G =</span> <span class="fu">list</span>(<span class="at">G1 =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="dv">1</span>,</span>
<span id="cb302-2"><a href="parameter-expansion.html#cb302-2" tabindex="-1"></a>    <span class="at">nu =</span> <span class="dv">1</span>, <span class="at">alpha.mu =</span> <span class="dv">0</span>, <span class="at">alpha.V =</span> <span class="dv">25</span><span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb302-3"><a href="parameter-expansion.html#cb302-3" tabindex="-1"></a>m7a<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">MCMCglmm</span>(estimate <span class="sc">~</span> <span class="dv">1</span>, <span class="at">random =</span> <span class="sc">~</span>school, <span class="at">rcov =</span> <span class="sc">~</span><span class="fu">idh</span>(school)<span class="sc">:</span>units, <span class="at">data =</span> schools,</span>
<span id="cb302-4"><a href="parameter-expansion.html#cb302-4" tabindex="-1"></a>    <span class="at">prior =</span> prior3)</span></code></pre></div>
<p>and Figure <a href="parameter-expansion.html#fig:school3">9.4</a> shows that the prior may have better properties than the inverse-gamma, and that the posterior is less distorted.</p>
<div class="figure"><span style="display:block;" id="fig:school3"></span>
<img src="_bookdown_files/fig/school3-1.png" alt="Between school standard deviation in educational test scores, with a Cauchy prior with a scale of 25." width="672" />
<p class="caption">
Figure 9.4: Between school standard deviation in educational test scores, with a Cauchy prior with a scale of 25.
</p>
</div>
</div>
<div id="binary-response-models" class="section level3 hasAnchor" number="9.0.3">
<h3><span class="header-section-number">9.0.3</span> Binary response models<a href="parameter-expansion.html#binary-response-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When analysing binary responses the residual variance is not identified in the likelihood and without a prior the posterior is improper. If a weak prior is placed on the residual variance then the chain appears to mix poorly and the MCMC output often looks terrible. However, this poor mixing is in some ways superficial. As discussed in Section
<a href="cat-int.html#cat-int">5</a> we can rescale the location effects and variances by the estimated residual variance to obtain the posterior distribution for some fixed value of the actual residual variance. For example, we can refit the sex ratio model using a residual variance fixed at ten rather than one:</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="parameter-expansion.html#cb303-1" tabindex="-1"></a>prior3b <span class="ot">=</span> <span class="fu">list</span>(<span class="at">R =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="dv">10</span>, <span class="at">fix =</span> <span class="dv">1</span>), <span class="at">G =</span> <span class="fu">list</span>(<span class="at">G1 =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="dv">1</span>, <span class="at">nu =</span> <span class="dv">1</span>, <span class="at">alpha.mu =</span> <span class="dv">0</span>,</span>
<span id="cb303-2"><a href="parameter-expansion.html#cb303-2" tabindex="-1"></a>    <span class="at">alpha.V =</span> <span class="dv">1000</span>)))</span>
<span id="cb303-3"><a href="parameter-expansion.html#cb303-3" tabindex="-1"></a>m7b<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">MCMCglmm</span>(sex <span class="sc">~</span> <span class="dv">1</span>, <span class="at">random =</span> <span class="sc">~</span>dam, <span class="at">data =</span> BTdata, <span class="at">family =</span> <span class="st">&quot;categorical&quot;</span>,</span>
<span id="cb303-4"><a href="parameter-expansion.html#cb303-4" tabindex="-1"></a>    <span class="at">prior =</span> prior3b)</span></code></pre></div>
<p>The two models appear to give completely different posteriors (Figure <a href="parameter-expansion.html#fig:sexratio2">9.5</a>)</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="parameter-expansion.html#cb304-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">mcmc.list</span>(m7b<span class="fl">.1</span><span class="sc">$</span>VCV[, <span class="dv">1</span>], m7b<span class="fl">.3</span><span class="sc">$</span>VCV[, <span class="dv">1</span>]))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:sexratio2"></span>
<img src="_bookdown_files/fig/sexratio2-1.png" alt="Between mother variation in sex ratio with the residual variance fixed at 1 (black trace) and 10 (red trace)." width="672" />
<p class="caption">
Figure 9.5: Between mother variation in sex ratio with the residual variance fixed at 1 (black trace) and 10 (red trace).
</p>
</div>
<p>but rescaling indicates that they are very similar:</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="parameter-expansion.html#cb305-1" tabindex="-1"></a>c2 <span class="ot">&lt;-</span> (<span class="dv">16</span> <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">3</span>)<span class="sc">/</span>(<span class="dv">15</span> <span class="sc">*</span> pi))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb305-2"><a href="parameter-expansion.html#cb305-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">mcmc.list</span>(m7b<span class="fl">.1</span><span class="sc">$</span>VCV[, <span class="dv">1</span>]<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> c2 <span class="sc">*</span> m7b<span class="fl">.1</span><span class="sc">$</span>VCV[, <span class="st">&quot;units&quot;</span>]), m7b<span class="fl">.3</span><span class="sc">$</span>VCV[, <span class="dv">1</span>]<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb305-3"><a href="parameter-expansion.html#cb305-3" tabindex="-1"></a>    c2 <span class="sc">*</span> m7b<span class="fl">.3</span><span class="sc">$</span>VCV[, <span class="st">&quot;units&quot;</span>])))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:sexratio3"></span>
<img src="_bookdown_files/fig/sexratio3-1.png" alt="Between mother variation in sex ratio with the residual variance fixed at 1 (black trace) and 10 (red trace) but with both estimates rescaled to what would be observed under no residual variance." width="672" />
<p class="caption">
Figure 9.6: Between mother variation in sex ratio with the residual variance fixed at 1 (black trace) and 10 (red trace) but with both estimates rescaled to what would be observed under no residual variance.
</p>
</div>
<p>The prior specification for the between mother variance is different in the two models but Figure <a href="parameter-expansion.html#fig:sexratio3">9.6</a> suggests that the difference has little influence. However, the mixing properties of the second chain are much better <span class="citation">(<a href="#ref-vanDyk.2001">Dyk and Meng 2001</a>)</span>:</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="parameter-expansion.html#cb306-1" tabindex="-1"></a><span class="fu">effectiveSize</span>(m7b<span class="fl">.1</span><span class="sc">$</span>VCV[, <span class="dv">1</span>]<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> c2 <span class="sc">*</span> m7b<span class="fl">.1</span><span class="sc">$</span>VCV[, <span class="st">&quot;units&quot;</span>]))</span></code></pre></div>
<pre><code>##     var1 
## 146.3417</code></pre>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="parameter-expansion.html#cb308-1" tabindex="-1"></a><span class="fu">effectiveSize</span>(m7b<span class="fl">.3</span><span class="sc">$</span>VCV[, <span class="dv">1</span>]<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> c2 <span class="sc">*</span> m7b<span class="fl">.3</span><span class="sc">$</span>VCV[, <span class="st">&quot;units&quot;</span>]))</span></code></pre></div>
<pre><code>##     var1 
## 689.2927</code></pre>
<p>Although the chain mixes faster as the residual variance is set to be larger, numerical problem are often encountered because the latent variables can take on extreme values. For most models a variance of 1 is safe, but care needs to be taken so that the absolute value of the latent variable is less than 20 in the case of the logit link and less than 7 for the probit link. If the residual variance is not fixed but has an alternative proper prior placed on it then the Metropolis-Hastings proposal distribution for the latent variables may not be well suited to the local properties of the conditional distribution and the acceptance ratio may fluctuate widely around the optimal 0.44. This can be fixed by using the slice sampling methods outlined in <span class="citation">Damien, Wakefield, and Walker (<a href="#ref-Damien.1999">1999</a>)</span> by passing <code>slice=TRUE</code> to <span class="math inline">\(\texttt{MCMCglmm}\)</span>. Slice sampling can also be more efficient even if the prior is fixed at some value:</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="parameter-expansion.html#cb310-1" tabindex="-1"></a>m7b<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">MCMCglmm</span>(sex <span class="sc">~</span> <span class="dv">1</span>, <span class="at">random =</span> <span class="sc">~</span>dam, <span class="at">data =</span> BTdata, <span class="at">family =</span> <span class="st">&quot;categorical&quot;</span>,</span>
<span id="cb310-2"><a href="parameter-expansion.html#cb310-2" tabindex="-1"></a>    <span class="at">prior =</span> prior3b, <span class="at">slice =</span> <span class="cn">TRUE</span>)</span>
<span id="cb310-3"><a href="parameter-expansion.html#cb310-3" tabindex="-1"></a><span class="fu">effectiveSize</span>(m7b<span class="fl">.4</span><span class="sc">$</span>VCV[, <span class="dv">1</span>]<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> c2 <span class="sc">*</span> m7b<span class="fl">.3</span><span class="sc">$</span>VCV[, <span class="st">&quot;units&quot;</span>]))</span></code></pre></div>
<pre><code>##     var1 
## 566.9598</code></pre>

</div>
</div>
<h3> References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Browne.2009" class="csl-entry">
Browne, W. J., F. Steele, M. Golalizadeh, and M. J. Green. 2009. <span>“The Use of Simple Reparameterizations to Improve the Efficiency of Markov Chain Monte Carlo Estimation for Multilevel Models with Applications to Discrete Time Survival Models.”</span> <em>Journal of the Royal Statistical Society Series <span>A</span> - Statistics in Society</em> 172: 579–98.
</div>
<div id="ref-Damien.1999" class="csl-entry">
Damien, P., J. Wakefield, and S. Walker. 1999. <span>“Gibbs Sampling for <span>B</span>ayesian Non–Conjugate and Hierarchical Models by Using Auxiliary Variables.”</span> <em>Journal of the Royal Statistical Society Series B-Statistical Methodology</em> 61: 331–44.
</div>
<div id="ref-vanDyk.2001" class="csl-entry">
Dyk, D. A. van, and X. L. Meng. 2001. <span>“The Art of Data Augmentation.”</span> <em>Journal of Computational and Graphical Statistics</em> 10 (1): 1–50.
</div>
<div id="ref-Gelman.2006" class="csl-entry">
Gelman, A. 2006. <span>“Prior Distributions for Variance Parameters in Hierarchical Models.”</span> <em>Bayesian Analysis</em> 1 (3): 515–33.
</div>
<div id="ref-Gelman.2008b" class="csl-entry">
Gelman, A., D. A. van Dyk, Z. Y. Huang, and W. J. Boscardin. 2008. <span>“Using Redundant Parameterizations to Fit Hierarchical Models.”</span> <em>Journal of Computational and Graphical Statistics</em> 17 (1): 95–122.
</div>
<div id="ref-Liu.1998" class="csl-entry">
Liu, C. H., D. B. Rubin, and Y. N. Wu. 1998. <span>“Parameter Expansion to Accelerate EM: The PX–EM Algorithm.”</span> <em>Biometrika</em> 85 (4): 755–70.
</div>
<div id="ref-Liu.1999" class="csl-entry">
Liu, J. S., and Y. N. Wu. 1999. <span>“Parameter Expansion for Data Augmentation.”</span> <em>Journal of the American Statistical Association</em> 94 (448): 1264–74.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="pedigree.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="path.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["MCMCglmm-course-notes.pdf", "MCMCglmm-course-notes.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
