<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Categorical Random Interactions | MCMCglmm Course Notes</title>
  <meta name="description" content="Extended documentation and course notes for the MCMCglmm R package." />
  <meta name="generator" content="bookdown 0.46 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Categorical Random Interactions | MCMCglmm Course Notes" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Extended documentation and course notes for the MCMCglmm R package." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Categorical Random Interactions | MCMCglmm Course Notes" />
  
  <meta name="twitter:description" content="Extended documentation and course notes for the MCMCglmm R package." />
  

<meta name="author" content="Jarrod Hadfield" />


<meta name="date" content="2025-12-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="glm.html"/>
<link rel="next" href="cont-int.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i><b>1</b> Overview</a>
<ul>
<li class="chapter" data-level="1.1" data-path="overview.html"><a href="overview.html#outline"><i class="fa fa-check"></i><b>1.1</b> Outline</a></li>
<li class="chapter" data-level="1.2" data-path="overview.html"><a href="overview.html#references"><i class="fa fa-check"></i><b>1.2</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="bayesian.html"><a href="bayesian.html"><i class="fa fa-check"></i><b>2</b> Bayesian Analysis and MCMC</a>
<ul>
<li class="chapter" data-level="2.1" data-path="bayesian.html"><a href="bayesian.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="bayesian.html"><a href="bayesian.html#likelihood"><i class="fa fa-check"></i><b>2.2</b> Likelihood</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="bayesian.html"><a href="bayesian.html#maximum-likelihood-ml"><i class="fa fa-check"></i><b>2.2.1</b> Maximum Likelihood (ML)</a></li>
<li class="chapter" data-level="2.2.2" data-path="bayesian.html"><a href="bayesian.html#restricted-maximum-likelihood-reml"><i class="fa fa-check"></i><b>2.2.2</b> Restricted Maximum Likelihood (REML)</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="bayesian.html"><a href="bayesian.html#prior-distribution"><i class="fa fa-check"></i><b>2.3</b> Prior Distribution</a></li>
<li class="chapter" data-level="2.4" data-path="bayesian.html"><a href="bayesian.html#posterior-distribution"><i class="fa fa-check"></i><b>2.4</b> Posterior Distribution</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="bayesian.html"><a href="bayesian.html#marginal-posterior-distribution"><i class="fa fa-check"></i><b>2.4.1</b> Marginal Posterior Distribution</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="bayesian.html"><a href="bayesian.html#mcmc"><i class="fa fa-check"></i><b>2.5</b> MCMC</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="bayesian.html"><a href="bayesian.html#starting-values"><i class="fa fa-check"></i><b>2.5.1</b> Starting values</a></li>
<li class="chapter" data-level="2.5.2" data-path="bayesian.html"><a href="bayesian.html#metrpolis-hastings-updates"><i class="fa fa-check"></i><b>2.5.2</b> Metrpolis-Hastings updates</a></li>
<li class="chapter" data-level="2.5.3" data-path="bayesian.html"><a href="bayesian.html#gibbs-sampling"><i class="fa fa-check"></i><b>2.5.3</b> Gibbs Sampling</a></li>
<li class="chapter" data-level="2.5.4" data-path="bayesian.html"><a href="bayesian.html#slice-sampling"><i class="fa fa-check"></i><b>2.5.4</b> Slice Sampling</a></li>
<li class="chapter" data-level="2.5.5" data-path="bayesian.html"><a href="bayesian.html#mcmc-diagnostics"><i class="fa fa-check"></i><b>2.5.5</b> MCMC Diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="bayesian.html"><a href="bayesian.html#IP-sec"><i class="fa fa-check"></i><b>2.6</b> Improper Priors</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="bayesian.html"><a href="bayesian.html#flat-improper-prior"><i class="fa fa-check"></i><b>2.6.1</b> Flat Improper Prior</a></li>
<li class="chapter" data-level="2.6.2" data-path="bayesian.html"><a href="bayesian.html#non-informative-improper-prior"><i class="fa fa-check"></i><b>2.6.2</b> Non-Informative Improper Prior</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="bayesian.html"><a href="bayesian.html#references-1"><i class="fa fa-check"></i><b>2.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>3</b> GLMs and GLMMs</a>
<ul>
<li class="chapter" data-level="3.1" data-path="glm.html"><a href="glm.html#linear-model-lm"><i class="fa fa-check"></i><b>3.1</b> Linear Model (LM)</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="glm.html"><a href="glm.html#lm-sec"><i class="fa fa-check"></i><b>3.1.1</b> Linear Predictors</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="glm.html"><a href="glm.html#generalised-linear-model-glm"><i class="fa fa-check"></i><b>3.2</b> Generalised Linear Model (GLM)</a></li>
<li class="chapter" data-level="3.3" data-path="glm.html"><a href="glm.html#over-dispersion"><i class="fa fa-check"></i><b>3.3</b> Over-dispersion</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="glm.html"><a href="glm.html#multiplicative-over-dispersion"><i class="fa fa-check"></i><b>3.3.1</b> Multiplicative Over-dispersion</a></li>
<li class="chapter" data-level="3.3.2" data-path="glm.html"><a href="glm.html#addod-sec"><i class="fa fa-check"></i><b>3.3.2</b> Additive Over-dispersion</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="glm.html"><a href="glm.html#ranef-sec"><i class="fa fa-check"></i><b>3.4</b> Random effects</a></li>
<li class="chapter" data-level="3.5" data-path="glm.html"><a href="glm.html#pred-sec"><i class="fa fa-check"></i><b>3.5</b> Prediction with Random effects</a></li>
<li class="chapter" data-level="3.6" data-path="glm.html"><a href="glm.html#categorical-data"><i class="fa fa-check"></i><b>3.6</b> Categorical Data</a></li>
<li class="chapter" data-level="3.7" data-path="glm.html"><a href="glm.html#PriorContr-sec"><i class="fa fa-check"></i><b>3.7</b> A note on fixed effect priors and covariances</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cat-int.html"><a href="cat-int.html"><i class="fa fa-check"></i><b>4</b> Categorical Random Interactions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="cat-int.html"><a href="cat-int.html#idh-variance-structure"><i class="fa fa-check"></i><b>4.1</b> <code>idh</code> Variance Structure</a></li>
<li class="chapter" data-level="4.2" data-path="cat-int.html"><a href="cat-int.html#us-variance-structure"><i class="fa fa-check"></i><b>4.2</b> <code>us</code> Variance Structure</a></li>
<li class="chapter" data-level="4.3" data-path="cat-int.html"><a href="cat-int.html#compound-variance-structures"><i class="fa fa-check"></i><b>4.3</b> Compound Variance Structures</a></li>
<li class="chapter" data-level="4.4" data-path="cat-int.html"><a href="cat-int.html#heter-sec"><i class="fa fa-check"></i><b>4.4</b> Heterogenous Residual Variance</a></li>
<li class="chapter" data-level="4.5" data-path="cat-int.html"><a href="cat-int.html#contrasts-and-covariances"><i class="fa fa-check"></i><b>4.5</b> Contrasts and Covariances</a></li>
<li class="chapter" data-level="4.6" data-path="cat-int.html"><a href="cat-int.html#VCVprior-sec"><i class="fa fa-check"></i><b>4.6</b> Priors for Covariance Matrices</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="cat-int.html"><a href="cat-int.html#priors-for-us-structures"><i class="fa fa-check"></i><b>4.6.1</b> Priors for <code>us</code> structures</a></li>
<li class="chapter" data-level="4.6.2" data-path="cat-int.html"><a href="cat-int.html#priors-for-idh-structures"><i class="fa fa-check"></i><b>4.6.2</b> Priors for <code>idh</code> structures</a></li>
<li class="chapter" data-level="4.6.3" data-path="cat-int.html"><a href="cat-int.html#priors-for-corg-and-corgh-structures"><i class="fa fa-check"></i><b>4.6.3</b> Priors for <code>corg</code> and <code>corgh</code> structures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="cont-int.html"><a href="cont-int.html"><i class="fa fa-check"></i><b>5</b> Continuous Random Interactions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="cont-int.html"><a href="cont-int.html#random-regression"><i class="fa fa-check"></i><b>5.1</b> Random Regression</a></li>
<li class="chapter" data-level="5.2" data-path="cont-int.html"><a href="cont-int.html#expected-variances-and-covariances"><i class="fa fa-check"></i><b>5.2</b> Expected Variances and Covariances</a></li>
<li class="chapter" data-level="5.3" data-path="cont-int.html"><a href="cont-int.html#RRcentering"><i class="fa fa-check"></i><b>5.3</b> <code>us</code> versus <code>idh</code> and mean centering</a></li>
<li class="chapter" data-level="5.4" data-path="cont-int.html"><a href="cont-int.html#meta-sec"><i class="fa fa-check"></i><b>5.4</b> Meta-analysis</a></li>
<li class="chapter" data-level="5.5" data-path="cont-int.html"><a href="cont-int.html#splines"><i class="fa fa-check"></i><b>5.5</b> Splines</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multi.html"><a href="multi.html"><i class="fa fa-check"></i><b>6</b> Multi-response models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="multi.html"><a href="multi.html#relaxing-the-univariate-assumptions-of-causality"><i class="fa fa-check"></i><b>6.1</b> Relaxing the univariate assumptions of causality</a></li>
<li class="chapter" data-level="6.2" data-path="multi.html"><a href="multi.html#multinomial-models"><i class="fa fa-check"></i><b>6.2</b> Multinomial Models</a></li>
<li class="chapter" data-level="6.3" data-path="multi.html"><a href="multi.html#zero-inflated-models"><i class="fa fa-check"></i><b>6.3</b> Zero-inflated Models</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="multi.html"><a href="multi.html#posterior-predictive-checks"><i class="fa fa-check"></i><b>6.3.1</b> Posterior predictive checks</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="multi.html"><a href="multi.html#Hurdle"><i class="fa fa-check"></i><b>6.4</b> Hurdle Models</a></li>
<li class="chapter" data-level="6.5" data-path="multi.html"><a href="multi.html#ZAP"><i class="fa fa-check"></i><b>6.5</b> Zero-altered Models</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="pedigree.html"><a href="pedigree.html"><i class="fa fa-check"></i><b>7</b> Pedigrees and Phylogenies</a>
<ul>
<li class="chapter" data-level="7.1" data-path="pedigree.html"><a href="pedigree.html#pedigree-and-phylogeny-formats"><i class="fa fa-check"></i><b>7.1</b> Pedigree and phylogeny formats</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="pedigree.html"><a href="pedigree.html#pedigrees"><i class="fa fa-check"></i><b>7.1.1</b> Pedigrees</a></li>
<li class="chapter" data-level="7.1.2" data-path="pedigree.html"><a href="pedigree.html#phylogenies"><i class="fa fa-check"></i><b>7.1.2</b> Phylogenies</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="pedigree.html"><a href="pedigree.html#the-animal-model-and-the-phylogenetic-mixed-model"><i class="fa fa-check"></i><b>7.2</b> The animal model and the phylogenetic mixed model</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="technical-details.html"><a href="technical-details.html"><i class="fa fa-check"></i><b>8</b> Technical Details</a>
<ul>
<li class="chapter" data-level="8.1" data-path="technical-details.html"><a href="technical-details.html#model-form"><i class="fa fa-check"></i><b>8.1</b> Model Form</a></li>
<li class="chapter" data-level="8.2" data-path="technical-details.html"><a href="technical-details.html#MCMC-app"><i class="fa fa-check"></i><b>8.2</b> MCMC Sampling Schemes</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="technical-details.html"><a href="technical-details.html#updating-the-latent-variables-bf-l"><i class="fa fa-check"></i><b>8.2.1</b> Updating the latent variables <span class="math inline">\({\bf l}\)</span></a></li>
<li class="chapter" data-level="8.2.2" data-path="technical-details.html"><a href="technical-details.html#updating-the-location-vector-boldsymbolmathbftheta-leftboldsymbolmathbfbeta-bf-uright"><i class="fa fa-check"></i><b>8.2.2</b> Updating the location vector <span class="math inline">\({\boldsymbol{\mathbf{\theta}}} = \left[{\boldsymbol{\mathbf{\beta}}}^{&#39;}\; {\bf u}^{&#39;}\right]^{&#39;}\)</span></a></li>
<li class="chapter" data-level="8.2.3" data-path="technical-details.html"><a href="technical-details.html#updating-the-variance-structures-bf-g-and-bf-r"><i class="fa fa-check"></i><b>8.2.3</b> Updating the variance structures <span class="math inline">\({\bf G}\)</span> and <span class="math inline">\({\bf R}\)</span></a></li>
<li class="chapter" data-level="8.2.4" data-path="technical-details.html"><a href="technical-details.html#ordinal-models"><i class="fa fa-check"></i><b>8.2.4</b> Ordinal Models</a></li>
<li class="chapter" data-level="8.2.5" data-path="technical-details.html"><a href="technical-details.html#path-analyses"><i class="fa fa-check"></i><b>8.2.5</b> Path Analyses</a></li>
<li class="chapter" data-level="8.2.6" data-path="technical-details.html"><a href="technical-details.html#deviance-and-dic"><i class="fa fa-check"></i><b>8.2.6</b> Deviance and DIC</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="parameter-expansion.html"><a href="parameter-expansion.html"><i class="fa fa-check"></i><b>9</b> Parameter Expansion</a>
<ul>
<li class="chapter" data-level="9.0.1" data-path="parameter-expansion.html"><a href="parameter-expansion.html#variances-close-to-zero"><i class="fa fa-check"></i><b>9.0.1</b> Variances close to zero</a></li>
<li class="chapter" data-level="9.0.2" data-path="parameter-expansion.html"><a href="parameter-expansion.html#binary-response-models"><i class="fa fa-check"></i><b>9.0.2</b> Binary response models</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="path.html"><a href="path.html"><i class="fa fa-check"></i><b>10</b> Path Analysis &amp; Antedependence Structures</a>
<ul>
<li class="chapter" data-level="10.1" data-path="path.html"><a href="path.html#path-anlaysis"><i class="fa fa-check"></i><b>10.1</b> Path Anlaysis</a></li>
<li class="chapter" data-level="10.2" data-path="path.html"><a href="path.html#antedependence"><i class="fa fa-check"></i><b>10.2</b> Antedependence</a></li>
<li class="chapter" data-level="10.3" data-path="path.html"><a href="path.html#scaling"><i class="fa fa-check"></i><b>10.3</b> Scaling</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MCMCglmm Course Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cat-int" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Categorical Random Interactions<a href="cat-int.html#cat-int" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Random effect specification is a common cause of confusion, especially
when we want to form interactions in the random terms. To illustrate the
possibilities we’ll use data collected on Blue tits.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="cat-int.html#cb122-1" tabindex="-1"></a><span class="fu">data</span>(BTdata)</span></code></pre></div>
<p>The data are morphological measurements (<code>tarsus</code> length and <code>back</code>
colour) made on 828 blue tit chicks from 106 mothers (<code>dam</code>). Half the
offspring from each mother were swapped with half the offspring from
another mother soon after hatching. The nest they were reared in is
recorded as <code>fosternest</code>.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="cat-int.html#cb123-1" tabindex="-1"></a>prior <span class="ot">=</span> <span class="fu">list</span>(<span class="at">R =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="dv">1</span>, <span class="at">nu =</span> <span class="fl">0.002</span>), <span class="at">G =</span> <span class="fu">list</span>(<span class="at">G1 =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="dv">1</span>, <span class="at">nu =</span> <span class="fl">0.002</span>),</span>
<span id="cb123-2"><a href="cat-int.html#cb123-2" tabindex="-1"></a>    <span class="at">G2 =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="dv">1</span>, <span class="at">nu =</span> <span class="fl">0.002</span>)))</span>
<span id="cb123-3"><a href="cat-int.html#cb123-3" tabindex="-1"></a>m3a<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">MCMCglmm</span>(tarsus <span class="sc">~</span> sex, <span class="at">random =</span> <span class="sc">~</span>dam <span class="sc">+</span> fosternest, <span class="at">data =</span> BTdata, <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb123-4"><a href="cat-int.html#cb123-4" tabindex="-1"></a>    <span class="at">prior =</span> prior)</span></code></pre></div>
<p>fits <code>sex</code> as a fixed effect, and <code>dam</code> and <code>fosternest</code> as random
effects.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="cat-int.html#cb124-1" tabindex="-1"></a><span class="fu">diag</span>(<span class="fu">autocorr</span>(m3a<span class="fl">.1</span><span class="sc">$</span>VCV)[<span class="dv">2</span>, , ])</span></code></pre></div>
<pre><code>##        dam fosternest      units 
## 0.07503325 0.39777468 0.02483234</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="cat-int.html#cb126-1" tabindex="-1"></a><span class="fu">plot</span>(m3a<span class="fl">.1</span><span class="sc">$</span>VCV)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:mBTVCV"></span>
<img src="MCMCglmm-course-notes_files/figure-html/mBTVCV-1.png" alt="MCMC summary plot for the variance components from model \texttt{m3a.1}." width="672" />
<p class="caption">
Figure 4.1: MCMC summary plot for the variance components from model .
</p>
</div>
<p>Perhaps the autocorrelation for the <code>fosternest</code> variance is a little
higher than we would like, and so we may like to run it for longer.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="cat-int.html#cb127-1" tabindex="-1"></a><span class="fu">effectiveSize</span>(m3a<span class="fl">.1</span><span class="sc">$</span>VCV)</span></code></pre></div>
<pre><code>##        dam fosternest      units 
##   758.9278   244.4345   787.2306</code></pre>
<p>Indeed, we’ve only sampled the fosternest variance about half as well as
the other two variance components.<br />
The posterior correlation between the parameters is low</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="cat-int.html#cb129-1" tabindex="-1"></a><span class="fu">cor</span>(m3a<span class="fl">.1</span><span class="sc">$</span>VCV)</span></code></pre></div>
<pre><code>##                     dam fosternest        units
## dam         1.000000000 -0.2389920 -0.009271033
## fosternest -0.238991972  1.0000000 -0.143917543
## units      -0.009271033 -0.1439175  1.000000000</code></pre>
<p>which is not that surprising give the data come from an experiment which
was designed in order to estimate these variance components. In general,
variance components will show negative posterior correlations because
the the total variance is being divided up. Imagine cutting a piece of
string; making one bit longer has to reduce the size of the other bits,
by necessity. If we hadn’t experimentally manipulated the birds then all
chicks with the same mother, would be raised in the same nest, and there
would be no information in the data to separate these terms. In this
case the posterior correlation between these parameters would approach
-1 as the prior information goes to zero.<br />
The lower 95% credible interval for the <code>fosternest</code> variance is low</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="cat-int.html#cb131-1" tabindex="-1"></a><span class="fu">HPDinterval</span>(m3a<span class="fl">.1</span><span class="sc">$</span>VCV)</span></code></pre></div>
<pre><code>##                  lower     upper
## dam        0.137581575 0.3212100
## fosternest 0.006742126 0.1236239
## units      0.514328574 0.6295843
## attr(,&quot;Probability&quot;)
## [1] 0.95</code></pre>
<p>and perhaps a model without it would be better supported, although the
DIC suggest not:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="cat-int.html#cb133-1" tabindex="-1"></a>priorb <span class="ot">&lt;-</span> prior</span>
<span id="cb133-2"><a href="cat-int.html#cb133-2" tabindex="-1"></a>priorb[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> priorb[[<span class="dv">2</span>]][<span class="sc">-</span><span class="dv">2</span>]</span>
<span id="cb133-3"><a href="cat-int.html#cb133-3" tabindex="-1"></a>m3a<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">MCMCglmm</span>(tarsus <span class="sc">~</span> sex, <span class="at">random =</span> <span class="sc">~</span>dam, <span class="at">data =</span> BTdata, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">prior =</span> priorb)</span>
<span id="cb133-4"><a href="cat-int.html#cb133-4" tabindex="-1"></a>m3a<span class="fl">.2</span><span class="sc">$</span>DIC</span></code></pre></div>
<pre><code>## [1] 2014.197</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="cat-int.html#cb135-1" tabindex="-1"></a>m3a<span class="fl">.1</span><span class="sc">$</span>DIC</span></code></pre></div>
<pre><code>## [1] 1991.738</code></pre>
<p>The tarsus lengths were standardised prior to analysis - this is not
recommended, but was done in the original analyses of these data
<span class="citation">(Hadfield et al. 2007)</span> so that comparisons would be scale invariant. The
original analyses were done in REML where it is hard to get accurate
confidence intervals for functions of variance components. With MCMC
procedures this is simple. For example if we want to know what
proportion of the total variance is explained by dams</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="cat-int.html#cb137-1" tabindex="-1"></a><span class="fu">HPDinterval</span>(m3a<span class="fl">.1</span><span class="sc">$</span>VCV[, <span class="dv">1</span>]<span class="sc">/</span><span class="fu">rowSums</span>(m3a<span class="fl">.1</span><span class="sc">$</span>VCV))</span></code></pre></div>
<pre><code>##          lower     upper
## var1 0.1713879 0.3462044
## attr(,&quot;Probability&quot;)
## [1] 0.95</code></pre>
<p>One nice thing though about standardised data is that effect sizes are
immediately apparent. For example, fixed effects are in standard
deviation units and the sex effects are non-trivial:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="cat-int.html#cb139-1" tabindex="-1"></a><span class="fu">summary</span>(m3a<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>## 
##  Iterations = 3001:12991
##  Thinning interval  = 10
##  Sample size  = 1000 
## 
##  DIC: 1991.738 
## 
##  G-structure:  ~dam
## 
##     post.mean l-95% CI u-95% CI eff.samp
## dam    0.2267   0.1376   0.3212    758.9
## 
##                ~fosternest
## 
##            post.mean l-95% CI u-95% CI eff.samp
## fosternest   0.06573 0.006742   0.1236    244.4
## 
##  R-structure:  ~units
## 
##       post.mean l-95% CI u-95% CI eff.samp
## units    0.5711   0.5143   0.6296    787.2
## 
##  Location effects: tarsus ~ sex 
## 
##             post.mean l-95% CI u-95% CI eff.samp  pMCMC    
## (Intercept)  -0.40389 -0.54089 -0.27833   1000.0 &lt;0.001 ***
## sexMale       0.76845  0.65826  0.87424   1000.0 &lt;0.001 ***
## sexUNK        0.20651 -0.05026  0.45051    785.5  0.126    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Given that the sexes differ in their mean phenotype it may be worth
exploring whether they vary in other ways. For example, perhaps there
are sex-limited genes that mean that related brothers resemble each
other more than they do their sisters. Perhaps females are less
sensitive to environmental variation? To fit these models it will be
necessary to understand how the variance functions, such as <code>us()</code> and
<code>idh()</code>, work. We could refit the model <code>m3a.1</code> using the random effect
specifications:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="cat-int.html#cb141-1" tabindex="-1"></a>random <span class="ot">=</span> <span class="er">~</span><span class="fu">us</span>(<span class="dv">1</span>)<span class="sc">:</span>dam <span class="sc">+</span> <span class="fu">us</span>(<span class="dv">1</span>)<span class="sc">:</span>fosternest</span></code></pre></div>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="cat-int.html#cb142-1" tabindex="-1"></a>random <span class="ot">=</span> <span class="er">~</span><span class="fu">idh</span>(<span class="dv">1</span>)<span class="sc">:</span>dam <span class="sc">+</span> <span class="fu">idh</span>(<span class="dv">1</span>)<span class="sc">:</span>fosternest</span></code></pre></div>
<p>and these would give exactly the same answer as the model specified as
<span class="math inline">\(^{\sim}\)</span><code>dam+fosternest</code>. The term inside the brackets is a model
formula and is interpreted exactly how you would interpret any R formula
expect the intercept is not fitted by default. These formula are
therefore fitting an intercept which is interacted with the random
effects. For the dam terms we can get a representation of the
interaction for the first few levels of <code>dam</code>:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="cat-int.html#cb143-1" tabindex="-1"></a><span class="fu">levels</span>(BTdata<span class="sc">$</span>dam)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>## [1] &quot;Fem2&quot;    &quot;Fem20&quot;   &quot;Fem3&quot;    &quot;Fem5&quot;    &quot;K983388&quot;</code></pre>
<p>Try this:</p>
<p><span class="math display">\[
{\color{red} \texttt{Fem2}}
\]</span></p>
<p><span class="math display">\[
\color{red}\texttt{Fem2}
\]</span></p>
<p><span class="math display">\[
{\textcolor{red} \texttt{Fem2}}
\]</span></p>
<p><span class="math display">\[
{\textcolor{red} \texttt{Fem2}}
\]</span></p>
<p><span class="math display">\[
\begin{array}{c|rrrrrc}
&amp;{\color{red} \texttt{Fem2}}&amp;{\color{red} \texttt{Fem20}}&amp;{\color{red} \texttt{Fem3}}&amp;{\color{red} \texttt{Fem5}}&amp;{\color{red} \texttt{K983388}}&amp;\dots\\
\hline\\
{\color{blue} \texttt{(1)}}&amp;{\color{blue} \texttt{(1)}}.{\color{red} \texttt{Fem2}}&amp;{\color{blue} \texttt{(1)}}.{\color{red} \texttt{Fem20}}&amp;{\color{blue} \texttt{(1)}}.{\color{red} \texttt{Fem3}}&amp;{\color{blue} \texttt{(1)}}.{\color{red} \texttt{Fem5}}&amp;{\color{blue} \texttt{(1)}}.{\color{red} \texttt{K983388}}&amp;\dots\\
\end{array}
\]</span></p>
<p>Across the top, we have the original dam effects in red, and along the
side we have the term defined by the variance structure formula (just
the intercept in this case). The interaction forms a new set of factors.
Although they have different names from the original <code>dam</code> levels, it is
clear that there is a one to one mapping between the original and the
new factor levels and the models are therefore equivalent. For more
complex interactions this is not the case.<br />
We could also fit <code>sex</code> in the variance structure model, (i.e.
<code>us(``sex``):``dam</code> or <code>idh(``sex``):``dam</code>)<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>:</p>
<p><span class="math display">\[\begin{array}{c|rrrrrc}
&amp;{\color{red} \texttt{Fem2}}&amp;{\color{red} \texttt{Fem20}}&amp;{\color{red} \texttt{Fem3}}&amp;{\color{red} \texttt{Fem5}}&amp;{\color{red} \texttt{K983388}}&amp;\dots\\
\hline\\
{\color{blue} \texttt{Fem}}&amp;{\color{blue} \texttt{Fem}}.{\color{red} \texttt{Fem2}}&amp;{\color{blue} \texttt{Fem}}.{\color{red} \texttt{Fem20}}&amp;{\color{blue} \texttt{Fem}}.{\color{red} \texttt{Fem3}}&amp;{\color{blue} \texttt{Fem}}.{\color{red} \texttt{Fem5}}&amp;{\color{blue} \texttt{Fem}}.{\color{red} \texttt{K983388}}&amp;\dots\\
{\color{blue} \texttt{Male}}&amp;{\color{blue} \texttt{Male}}.{\color{red} \texttt{Fem2}}&amp;{\color{blue} \texttt{Male}}.{\color{red} \texttt{Fem20}}&amp;{\color{blue} \texttt{Male}}.{\color{red} \texttt{Fem3}}&amp;{\color{blue} \texttt{Male}}.{\color{red} \texttt{Fem5}}&amp;{\color{blue} \texttt{Male}}.{\color{red} \texttt{K983388}}&amp;\dots\\
{\color{blue} \texttt{UNK}}&amp;{\color{blue} \texttt{UNK}}.{\color{red} \texttt{Fem2}}&amp;{\color{blue} \texttt{UNK}}.{\color{red} \texttt{Fem20}}&amp;{\color{blue} \texttt{UNK}}.{\color{red} \texttt{Fem3}}&amp;{\color{blue} \texttt{UNK}}.{\color{red} \texttt{Fem5}}&amp;{\color{blue} \texttt{UNK}}.{\color{red} \texttt{K983388}}&amp;\dots\\
\end{array}\]</span></p>
<p>which creates three times as many random factors, one associated with
offspring of each sex for each each dam.</p>
<div id="idh-variance-structure" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> <code>idh</code> Variance Structure<a href="cat-int.html#idh-variance-structure" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The different variance functions make different assumptions about how
the effects associated with these different factors are distributed.
First, we may want to allow the variance in the effects to be different
for each row of factors; i.e. does the identity of a chicks mother
explain different amounts of variation depending on the sex of the
chick. We can fit this model using the <code>idh</code> function and represent our
belief in how the effects are distributed as a <span class="math inline">\(3\times3\)</span> covariance
matrix <span class="math inline">\({\bf V}\)</span>:</p>
<p><span class="math display">\[{\bf V}_{{\color{red} \texttt{dam}}}=
\left[
\begin{array}{ccc}
\sigma^{2}_{\color{blue}\texttt{Female}}&amp;0&amp;0\\
0&amp;\sigma^{2}_{\color{blue}\texttt{Male}}&amp;0\\
0&amp;0&amp;\sigma^{2}_{\color{blue}\texttt{UNK}}\\
\end{array}
\right]\]</span></p>
<p>In the simpler models we had fitted in Chapters
<a href="#chap1" reference-type="ref" reference="chap1"><span class="math display">\[chap1\]</span></a> and
<a href="#chap2" reference-type="ref" reference="chap2"><span class="math display">\[chap2\]</span></a> <span class="math inline">\({\bf V}\)</span>
was a scalar (<span class="math inline">\({\bf V} = \sigma^{2}\)</span>) rather than a matrix, and the
prior specification was relatively simple. We will come back to prior
specifications for covariance matrices in Section
<a href="cat-int.html#VCVprior-sec" reference-type="ref" reference="VCVprior-sec">6</a>, but
for now note that the prior for the dam component has <code>V</code> as a
<span class="math inline">\(3\times3\)</span> identity matrix:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="cat-int.html#cb145-1" tabindex="-1"></a>priorb <span class="ot">=</span> <span class="fu">list</span>(<span class="at">R =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="fu">diag</span>(<span class="dv">1</span>), <span class="at">nu =</span> <span class="fl">0.002</span>), <span class="at">G =</span> <span class="fu">list</span>(<span class="at">G1 =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="fu">diag</span>(<span class="dv">3</span>),</span>
<span id="cb145-2"><a href="cat-int.html#cb145-2" tabindex="-1"></a>    <span class="at">nu =</span> <span class="fl">0.002</span>), <span class="at">G2 =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="dv">1</span>, <span class="at">nu =</span> <span class="fl">0.002</span>)))</span>
<span id="cb145-3"><a href="cat-int.html#cb145-3" tabindex="-1"></a>m3a<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">MCMCglmm</span>(tarsus <span class="sc">~</span> sex, <span class="at">random =</span> <span class="sc">~</span><span class="fu">idh</span>(sex)<span class="sc">:</span>dam <span class="sc">+</span> fosternest, <span class="at">data =</span> BTdata,</span>
<span id="cb145-4"><a href="cat-int.html#cb145-4" tabindex="-1"></a>    <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">prior =</span> priorb)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:BTidh"></span>
<img src="MCMCglmm-course-notes_files/figure-html/BTidh-1.png" alt="MCMC summary plot for the sex-specific dam variance components from model \texttt{m3a.3}. The number of chicks with unknown (\texttt{UNK}) sex is low, with very little replication within dams. The posterior distribution for the \texttt{UNK} variance component is dominated by the prior which has a marginal distribution of \texttt{V=1} and \texttt{nu=0.002}." width="672" />
<p class="caption">
Figure 4.2: MCMC summary plot for the sex-specific dam variance components from model . The number of chicks with unknown () sex is low, with very little replication within dams. The posterior distribution for the variance component is dominated by the prior which has a marginal distribution of and .
</p>
</div>
<p>The sex specific variances for males and females look pretty similar,
but the sex-specific variance for birds with unknown sex is not behaving
well. This is not that surprising given that there are only
47 birds with unknown sex and these tend to be
thinly spread across dams. This variance component is likely to be
dominated by the prior, but for now we’ll leave the model as it is and
come back to some possible alternative solutions later.<br />
We can extract the marginal means for each variance and place them into
a matrix:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="cat-int.html#cb146-1" tabindex="-1"></a>Vdam<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">colMeans</span>(m3a<span class="fl">.3</span><span class="sc">$</span>VCV)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb146-2"><a href="cat-int.html#cb146-2" tabindex="-1"></a><span class="fu">colnames</span>(Vdam<span class="fl">.3</span>) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(m3a<span class="fl">.3</span><span class="sc">$</span>VCV)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb146-3"><a href="cat-int.html#cb146-3" tabindex="-1"></a>Vdam<span class="fl">.3</span></span></code></pre></div>
<pre><code>##      sexFem.dam sexMale.dam sexUNK.dam
## [1,]  0.1744207   0.0000000 0.00000000
## [2,]  0.0000000   0.1687947 0.00000000
## [3,]  0.0000000   0.0000000 0.04943036</code></pre>
<p>Note, that they are in general less than the marginal mean of the dam
variance in model <code>m3a.1</code>
(0.227) where a sex interaction
was not fitted. Because the dam effects are assumed to be multivariate
normal we can plot an ellipsoid that completely represents their
distribution (you can rotate the figure in R):</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="cat-int.html#cb148-1" tabindex="-1"></a><span class="fu">plotsubspace</span>(Vdam<span class="fl">.3</span>, <span class="at">axes.lab =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>If we had measured the offspring of a lot of dams, and for each dam we
had measured a very large number of offspring of each sex, then we could
calculate the average tarsus lengths within a nest for males, females
and unknowns separately. If we produced a scatter plot of these means
the data would have the same shape as this ellipsoid and 95% of the data
would lie inside.</p>
</div>
<div id="us-variance-structure" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> <code>us</code> Variance Structure<a href="cat-int.html#us-variance-structure" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The oddity of the model, and the meaning of the off-diagonal zeros,
should become apparent. We have assumed that the different sexes with in
a nest are independent. If we plotted the average tarsus lengths for
males against the average tarsus lengths for females for each dam this
model implies we should see no relationship. We can relax this
assumption using the <code>us</code> function which estimates the matrix:</p>
<p><span class="math display">\[{\bf V}_{{\color{red} \texttt{dam}}}=
\left[
\begin{array}{ccc}
\sigma^{2}_{\color{blue}\texttt{Female}}&amp;\sigma_{\color{blue}\texttt{Female}, \texttt{Male}}&amp;\sigma_{\color{blue}\texttt{Female}, \texttt{UNK}}\\
\sigma_{\color{blue}\texttt{Female}, \texttt{Male}}&amp;\sigma^{2}_{\color{blue}\texttt{Male}}&amp;\sigma_{\color{blue}\texttt{Male}, \texttt{UNK}}\\
\sigma_{\color{blue}\texttt{Female}, \texttt{UNK}}&amp;\sigma_{\color{blue}\texttt{Male}, \texttt{UNK}}&amp;\sigma^{2}_{\color{blue}\texttt{UNK}}\\
\end{array}
\right]\]</span></p>
<p>We will now use a prior for the covariance matrix where nu=4 (1 more
than the dimension of <strong>V</strong>) and the prior covariance matrix is an
diagonal matrix with small variances. This may seem surprising but the
motivation is laid out in Section
<a href="cat-int.html#VCVprior-sec" reference-type="ref" reference="VCVprior-sec">6</a>:</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="cat-int.html#cb149-1" tabindex="-1"></a>prior.m3a<span class="fl">.4</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">R =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="fu">diag</span>(<span class="dv">1</span>), <span class="at">nu =</span> <span class="fl">0.002</span>), <span class="at">G =</span> <span class="fu">list</span>(<span class="at">G1 =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="fu">diag</span>(<span class="dv">3</span>) <span class="sc">*</span></span>
<span id="cb149-2"><a href="cat-int.html#cb149-2" tabindex="-1"></a>    <span class="fl">0.02</span>, <span class="at">nu =</span> <span class="dv">4</span>), <span class="at">G2 =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="dv">1</span>, <span class="at">nu =</span> <span class="fl">0.002</span>)))</span>
<span id="cb149-3"><a href="cat-int.html#cb149-3" tabindex="-1"></a>m3a<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">MCMCglmm</span>(tarsus <span class="sc">~</span> sex, <span class="at">random =</span> <span class="sc">~</span><span class="fu">us</span>(sex)<span class="sc">:</span>dam <span class="sc">+</span> fosternest, <span class="at">data =</span> BTdata,</span>
<span id="cb149-4"><a href="cat-int.html#cb149-4" tabindex="-1"></a>    <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">prior =</span> prior.m3a<span class="fl">.4</span>)</span></code></pre></div>
<p>The posterior mean (co)variances for this model show that the
covariances are almost the same magnitude as the variances suggesting
strong correlations:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="cat-int.html#cb150-1" tabindex="-1"></a>Vdam<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">colMeans</span>(m3a<span class="fl">.4</span><span class="sc">$</span>VCV)[<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>], <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb150-2"><a href="cat-int.html#cb150-2" tabindex="-1"></a><span class="fu">colnames</span>(Vdam<span class="fl">.4</span>) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(m3a<span class="fl">.4</span><span class="sc">$</span>VCV)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb150-3"><a href="cat-int.html#cb150-3" tabindex="-1"></a>Vdam<span class="fl">.4</span></span></code></pre></div>
<pre><code>##      sexFem:sexFem.dam sexMale:sexFem.dam sexUNK:sexFem.dam
## [1,]         0.2307946          0.2006813         0.2243895
## [2,]         0.2006813          0.2151767         0.2179689
## [3,]         0.2243895          0.2179689         0.2883125</code></pre>
<p>The distribution of dam effects in this model looks substantially
different (Figure <a href="#rgl2-fig" reference-type="ref" reference="rgl2-fig"><span class="math display">\[rgl2-fig\]</span></a>):</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="cat-int.html#cb152-1" tabindex="-1"></a><span class="fu">plotsubspace</span>(Vdam<span class="fl">.4</span>, <span class="at">axes.lab =</span> <span class="cn">TRUE</span>, <span class="at">wire.frame =</span> T)</span></code></pre></div>
<p>Covariances can be hard to interpret, and I usually find correlations
easier to think about. They can also be useful for detecting problems in
the chain. In model <code>m3a.1</code> the dam variance for chicks with unknown sex
was behaving badly and was getting ‘trapped’ at zero. When fitting a
<span class="math inline">\(2\times2\)</span> covariance matrix similar things can happen when correlations
are close to -1 and 1, and this may not be obvious from the marginal
distribution of the covariances:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="cat-int.html#cb153-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">posterior.cor</span>(m3a<span class="fl">.4</span><span class="sc">$</span>VCV[, <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>])[, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">7</span>)])</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:BTcor"></span>
<img src="MCMCglmm-course-notes_files/figure-html/BTcor-1.png" alt="MCMC summary plot for the between sex correlations in dam effects from model \texttt{m3a.4}." width="672" />
<p class="caption">
Figure 4.3: MCMC summary plot for the between sex correlations in dam effects from model .
</p>
</div>
<p>All the correlations are very close to one, and the variances all pretty
equal so we’d probably consider the simpler model. We could try using
DIC to compare models, although given the different prior specifications
for the two models it is unclear whether this would be meaningful.
However, the simpler model does seem to have better support as intuition
suggests:</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="cat-int.html#cb154-1" tabindex="-1"></a>m3a<span class="fl">.4</span><span class="sc">$</span>DIC</span></code></pre></div>
<pre><code>## [1] 1996.578</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="cat-int.html#cb156-1" tabindex="-1"></a>m3a<span class="fl">.1</span><span class="sc">$</span>DIC</span></code></pre></div>
<pre><code>## [1] 1991.738</code></pre>
</div>
<div id="compound-variance-structures" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Compound Variance Structures<a href="cat-int.html#compound-variance-structures" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are also ways of specifying models that lie somewhere between the
simple model (<code>mBT</code>), where dam effects are assumed to be equivalent
across the sexes, and the most complex model (<code>mBT2</code>), where dam effects
are allowed to vary across the sexes and covary between the sexes to
different degrees. Some alternatives are listed in Table
<a href="#tab:T1" reference-type="ref" reference="rspec">1</a>.<br />
To be completed .…<br />
</p>
<div class="landscape">
<div id="rspec">
<table>
<tbody>
<tr class="odd">
<td align="center"><code>lmer</code> <code>MCMCglmm</code>/<code>asreml</code> No. Parameters Variance Correlation</td>
</tr>
</tbody>
</table>
<pre><code>      `(1|dam)`                 `dam`                1                                                             $\left[                                                                           $\left[
                                                                                                             \begin{array}{ccc}                                                                \begin{array}{ccc}
                                                                                                                   V&amp;V&amp;V\\                                                      {\color{red} 1}&amp;{\color{red} 1}&amp;{\color{red} 1}\\
                                                                                                                   V&amp;V&amp;V\\                                                      {\color{red} 1}&amp;{\color{red} 1}&amp;{\color{red} 1}\\
                                                                                                                   V&amp;V&amp;V\\                                                      {\color{red} 1}&amp;{\color{red} 1}&amp;{\color{red} 1}\\
                                                                                                                 \end{array}                                                                       \end{array}
                                                                                                                  \right]$                                                                          \right]$



    `(sex-1|dam)`           `us(sex):dam`            6                                                             $\left[                                                                           $\left[
                                                                                                             \begin{array}{ccc}                                                                \begin{array}{ccc}
                                                                                                          V_{1,1}&amp;C_{1,2}&amp;C_{1,3}\\                                                     {\color{red} 1}&amp;r_{1,2}&amp;r_{1,3}\\
                                                                                                          C_{1,2}&amp;V_{2,2}&amp;C_{2,3}\\                                                     r_{1,2}&amp;{\color{red} 1}&amp;r_{2,3}\\
                                                                                                          C_{1,3}&amp;C_{2,3}&amp;V_{3,3}\\                                                     r_{1,3}&amp;r_{2,3}&amp;{\color{red} 1}\\
                                                                                                                 \end{array}                                                                       \end{array}
                                                                                                                  \right]$                                                                          \right]$



    `(1|sex:dam)`             `sex:dam`              1                                                             $\left[                                                                           $\left[
                                                                                                             \begin{array}{ccc}                                                                \begin{array}{ccc}
                                                                                                     V&amp;{\color{red} 0}&amp;{\color{red} 0}\\                                        {\color{red} 1}&amp;{\color{red} 0}&amp;{\color{red} 0}\\
                                                                                                     {\color{red} 0}&amp;V&amp;{\color{red} 0}\\                                        {\color{red} 0}&amp;{\color{red} 1}&amp;{\color{red} 0}\\
                                                                                                     {\color{red} 0}&amp;{\color{red} 0}&amp;V\\                                        {\color{red} 0}&amp;{\color{red} 0}&amp;{\color{red} 1}\\
                                                                                                                 \end{array}                                                                       \end{array}
                                                                                                                  \right]$                                                                          \right]$</code></pre>
<p><code>(1|dam)</code>+<code>(1|sex:dam)</code> <code>dam</code>+<code>sex:dam</code> 2 $$ ]$</p>
<pre><code>         \-                `idh(sex):dam`            3                                                             $\left[                                                                           $\left[
                                                                                                             \begin{array}{ccc}                                                                \begin{array}{ccc}
                                                                                                  V_{1,1}&amp;{\color{red} 0}&amp;{\color{red} 0}\\                                     {\color{red} 1}&amp;{\color{red} 0}&amp;{\color{red} 0}\\
                                                                                                  {\color{red} 0}&amp;V_{2,2}&amp;{\color{red} 0}\\                                     {\color{red} 0}&amp;{\color{red} 1}&amp;{\color{red} 0}\\
                                                                                                  {\color{red} 0}&amp;{\color{red} 0}&amp;V_{3,3}\\                                     {\color{red} 0}&amp;{\color{red} 0}&amp;{\color{red} 1}\\
                                                                                                                 \end{array}                                                                       \end{array}
                                                                                                                  \right]$                                                                          \right]$



         \-                `corg(sex):dam`           3                                                             $\left[                                                                           $\left[
                                                                                                             \begin{array}{ccc}                                                                \begin{array}{ccc}
                                                                                                      {\color{red} 1}&amp;r_{1,2}&amp;r_{1,3}\\                                                 {\color{red} 1}&amp;r_{1,2}&amp;r_{1,3}\\
                                                                                                      r_{1,2}&amp;{\color{red} 1}&amp;r_{2,3}\\                                                 r_{1,2}&amp;{\color{red} 1}&amp;r_{2,3}\\
                                                                                                      r_{1,3}&amp;r_{2,3}&amp;{\color{red} 1}\\                                                 r_{1,3}&amp;r_{2,3}&amp;{\color{red} 1}\\
                                                                                                                 \end{array}                                                                       \end{array}
                                                                                                                  \right]$                                                                          \right]$



         \-               `corgh(sex):dam`           3                                                             $\left[                                                                           $\left[
                                                                                                             \begin{array}{ccc}                                                                \begin{array}{ccc}
                                                                {\color{red} V_{1,1}}&amp;r_{1,2}\sqrt{{\color{red} V_{1,1}V_{2,2}}}&amp;r_{1,3}\sqrt{{\color{red} V_{1,1}V_{2,2}}}\\           {\color{red} 1}&amp;r_{1,2}&amp;r_{1,3}\\
                                                                r_{1,2}\sqrt{{\color{red} V_{1,1}V_{2,2}}}&amp;{\color{red} V_{2,2}}&amp;r_{2,3}\sqrt{{\color{red} V_{2,2}V_{2,3}}}\\           r_{1,2}&amp;{\color{red} 1}&amp;r_{2,3}\\
                                                                r_{1,3}\sqrt{{\color{red} V_{1,1}V_{3,3}}}&amp;r_{2,3}\sqrt{{\color{red} V_{2,2}V_{3,3}}}&amp;{\color{red} V_{3,3}}\\           r_{1,3}&amp;r_{2,3}&amp;{\color{red} 1}\\
                                                                                                                 \end{array}                                                                       \end{array}
                                                                                                                  \right]$                                                                          \right]$</code></pre>
<hr />
<p>: (#tab:T1) Different random effect specifications in <code>lmer</code>,
<code>MCMCglmm</code> and <code>asreml</code>. <code>sex</code> is a factor with three levels so the
resulting matrix is <span class="math inline">\(3\times3\)</span>. Continuous variables can also go on
the LHS of the pipe, or within the variance structure functions (e.g.
<code>us</code>,<code>idh</code>). In this case the associated parameters are regression
coefficients for which a variance is estimated. For example, if the
chicks were of different ages (or we’d measured the same chicks at
different ages) we may want to see if the growth rate is more similar
for chicks raised by the same mother. <code>(1+age|dam)</code> or <code>us(1+age):dam</code>
estimates a <span class="math inline">\(2\times2\)</span> matrix which includes the variance in
intercepts (when <code>age</code>=0), the variance in slopes, and the covariance
that exists between them. Fixed parameters are in red.</p>
</div>
</div>
</div>
<div id="heter-sec" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Heterogenous Residual Variance<a href="cat-int.html#heter-sec" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To be started... In short - if you’ve fitted a sex by dam interaction I
would always allow the sexes to have different residual variances. Use
<code>rcov=</code><span class="math inline">\(\sim\)</span><code>idh(sex):units</code>.</p>
</div>
<div id="contrasts-and-covariances" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Contrasts and Covariances<a href="cat-int.html#contrasts-and-covariances" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A general method for seeing what a particular random specification means
in terms of the original variables is to realise that</p>
<p><span class="math display" id="eq:conv-eq">\[{\boldsymbol{\mathbf{\Sigma}}} = {\bf Z}{\bf V}{\bf Z}^{&#39;}
\label{conv-eq}   \tag{4.1}\]</span></p>
<p>where <span class="math inline">\({\boldsymbol{\mathbf{\Sigma}}}\)</span> is the covariance matrix for the
original set of variables and <span class="math inline">\({\bf V}\)</span> the variances associated with
the variance structure model. <span class="math inline">\({\bf Z}\)</span> is the random effect design
matrix. Equation <a href="cat-int.html#eq:conv-eq">(4.1)</a> implies:</p>
<p><span class="math display">\[{\bf V} = {\bf Z}^{-1}{\boldsymbol{\mathbf{\Sigma}}}({\bf Z}^{&#39;})^{-1}\]</span></p>
<p>or alternatively:</p>
<p><span class="math display">\[{\bf V} = ({\bf Z}{\bf Z}^{&#39;})^{-}{\bf Z}^{&#39;}{\boldsymbol{\mathbf{\Sigma}}}{\bf Z}({\bf Z}^{&#39;}{\bf Z})^{-}\]</span></p>
<p>if <span class="math inline">\({\bf Z}\)</span> is non-square and/or singular, where <span class="math inline">\(^{-}\)</span> is a
generalised inverse.<br />
</p>
</div>
<div id="VCVprior-sec" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Priors for Covariance Matrices<a href="cat-int.html#VCVprior-sec" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Priors for covariance matrices are tricky. What maybe non-informative
for a covariance may be informative for a correlation and <em>vice versa</em>.</p>
<div id="priors-for-us-structures" class="section level3 hasAnchor" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Priors for <code>us</code> structures<a href="cat-int.html#priors-for-us-structures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A useful result is that the marginal distribution of a variance is also
inverse - Wishart distributed:</p>
<p><span class="math display">\[\sigma^{2}_{1} \sim IW\left(\texttt{nu}^{\ast}\texttt{=nu-dim(V)+1},\ \texttt{V}^{\ast}=\frac{\texttt{nu}}{\texttt{nu}^{\ast}}\texttt{V[1,1]}\right)\]</span></p>
<p>using the first variance as an example, and indicating the new
parameters with an asterisk.<br />
An uninformative prior for the correlations is an improper prior with
<code>V=diag(dim(V))</code><span class="math inline">\(\ast\)</span><code>0</code> and <code>nu=dim(V)+1</code>. For the <span class="math inline">\(3\times3\)</span> sex by
dam covariance matrix in model <code>m3a.4</code> we used a proper prior with
<code>V=diag(3)</code><span class="math inline">\(\ast\)</span><code>0.02</code> and <code>nu=4</code> in the hope that this would be
relatively uninformative for the correlations. We can plot the marginal
density of the variances for this distribution as we did in Chapter
<a href="#chap1" reference-type="ref" reference="chap1"><span class="math display">\[chap1\]</span></a>:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="cat-int.html#cb160-1" tabindex="-1"></a>nu.ast <span class="ot">&lt;-</span> prior.m3a<span class="fl">.4</span><span class="sc">$</span>G<span class="sc">$</span>G1<span class="sc">$</span>nu <span class="sc">-</span> <span class="fu">dim</span>(prior.m3a<span class="fl">.4</span><span class="sc">$</span>G<span class="sc">$</span>G1<span class="sc">$</span>V)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb160-2"><a href="cat-int.html#cb160-2" tabindex="-1"></a>V.ast <span class="ot">&lt;-</span> prior.m3a<span class="fl">.4</span><span class="sc">$</span>G<span class="sc">$</span>G1<span class="sc">$</span>V[<span class="dv">1</span>, <span class="dv">1</span>] <span class="sc">*</span> (prior.m3a<span class="fl">.4</span><span class="sc">$</span>G<span class="sc">$</span>G1<span class="sc">$</span>nu<span class="sc">/</span>nu.ast)</span>
<span id="cb160-3"><a href="cat-int.html#cb160-3" tabindex="-1"></a>xv <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">1e-16</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">100</span>)</span>
<span id="cb160-4"><a href="cat-int.html#cb160-4" tabindex="-1"></a>dv <span class="ot">&lt;-</span> <span class="fu">dgamma</span>(<span class="dv">1</span><span class="sc">/</span>xv, <span class="at">shape =</span> nu.ast<span class="sc">/</span><span class="dv">2</span>, <span class="at">scale =</span> (nu.ast <span class="sc">*</span> V.ast)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span>(xv<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb160-5"><a href="cat-int.html#cb160-5" tabindex="-1"></a><span class="fu">plot</span>(dv <span class="sc">~</span> xv, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:NIc"></span>
<img src="MCMCglmm-course-notes_files/figure-html/NIc-1.png" alt="Marginal prior distribution of a variance using an inverse Wishart prior for the covariance matrix with \texttt{V=diag(3)*0.02} and \texttt{nu=4}." width="672" />
<p class="caption">
Figure 4.4: Marginal prior distribution of a variance using an inverse Wishart prior for the covariance matrix with and .
</p>
</div>
<p>In Chapter <a href="#chap2" reference-type="ref" reference="chap2"><span class="math display">\[chap2\]</span></a>
we saw that a non-informative prior for a variance component was <code>V=0</code>
and <code>nu=-2</code>. This result generalises to covariance matrices where the
improper prior <code>V=diag(dim(V))</code><span class="math inline">\(\ast\)</span><code>0</code> and <code>nu=dim(V)-3</code> is
non-informative for the variances and covariances. This can be verified
for the variances using the results derived above for the marginal
distribution:</p>
$$
<span class="math display">\[\begin{array}{rl}
\sigma^{2}_{1} \sim&amp; IW\left(\texttt{nu}^{\ast}\texttt{=dim(V)-3-dim(V)+1},\ \texttt{V}^{\ast}=\frac{\texttt{nu}}{\texttt{nu}^{\ast}}\texttt{0}\right)\\
               \sim&amp; IW\left(\texttt{nu}^{\ast}\texttt{=-2},\ \texttt{V}^{\ast}=\texttt{0}\right)\\

\end{array}\]</span>
<p>$$</p>
</div>
<div id="priors-for-idh-structures" class="section level3 hasAnchor" number="4.6.2">
<h3><span class="header-section-number">4.6.2</span> Priors for <code>idh</code> structures<a href="cat-int.html#priors-for-idh-structures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For <code>idh</code> the diagonal elements of the matrix are independent and each
variance is distributed as<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>:</p>
<p><span class="math display">\[\sigma^{2}_{1} \sim IW\left(\texttt{nu}^{\ast}\texttt{=nu},\ \texttt{V}^{\ast}=\texttt{V[1,1]}\right)\]</span></p>
</div>
<div id="priors-for-corg-and-corgh-structures" class="section level3 hasAnchor" number="4.6.3">
<h3><span class="header-section-number">4.6.3</span> Priors for <code>corg</code> and <code>corgh</code> structures<a href="cat-int.html#priors-for-corg-and-corgh-structures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For <code>corg</code> and <code>corgh</code> structures<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a> the diagonals of <code>V</code> define the
fixed variances (<code>corgh</code>) or are ignored and the variances set to one
(<code>corg</code>). I use the prior specification in <span class="citation">Barnard, McCulloch, and Meng (2000)</span> where <code>nu</code>
controls how much the correlation matrix approaches an identity matrix.
The marginal distribution of individual correlations (<span class="math inline">\(r\)</span>) is given by
<span class="citation">Barnard, McCulloch, and Meng (2000; and Box and Tiao 1973)</span>:</p>
<p><span class="math display">\[\begin{array}{lr}
Pr(r) \propto (1-r^{2})^\frac{\texttt{nu-dim(V)-1}}{\texttt{2}}, &amp; |r|&lt;1\\
\end{array}\]</span></p>
<p>and as shown above setting <code>nu</code> =<code>dim(V)+1</code> results in marginal
correlations that are uniform on the interval <span class="math display">\[-1,1\]</span>.<br />
In most cases correlation matrices do not have known form and so cannot
be directly Gibbs sampled. <code>MCMCglmm</code> uses a method proposed by
<span class="citation">X. F. Liu and Daniels (2006)</span> with the target prior as in <span class="citation">Barnard, McCulloch, and Meng (2000)</span>. Generally this
algorithm is very efficient as the Metropolis-Hastings acceptance
probability only depends on the degree to which the candidate prior and
the target prior (the prior you specify) conflict. The candidate prior
is equivalent to the prior in <span class="citation">Barnard, McCulloch, and Meng (2000)</span> with <code>nu=0</code> so as long as a
diffuse prior is set, mixing is generally not a problem. If <code>nu=0</code> is
set (the default) then the Metropolis-Hastings steps are always accepted
resulting in Gibbs sampling. However, a prior of this form puts high
density on extreme correlations which can cause problems if the data
give support to correlations in this region.<br />
<span id="VCVprior-sec" label="VCVprior-sec"></span>
:::::</p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="4">
<li id="fn4"><p>Earlier versions of the CourseNotes had <code>nu=1.002</code>. In versions
<span class="math inline">\(&lt;\)</span><!-- -->2.05 the marginal prior of a variance associated
with an <code>idh</code> structure was inverse-Wishart with
<span class="math inline">\(\texttt{nu}^{\ast}=\texttt{nu}-1\)</span> where <span class="math inline">\(\texttt{nu}^{\ast}\)</span> is the
marginal degree of belief. In versions <span class="math inline">\(&gt;=\)</span><!-- -->2.05 I
changed this so that <span class="math inline">\(\texttt{nu}^{\ast}=\texttt{nu}\)</span> as it was
leading to confusion.<a href="cat-int.html#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>IMPORTANT: In versions <span class="math inline">\(&lt;\)</span> 2.05 priors on each variance of an
<code>idh</code> structure were distributed as
<span class="math inline">\(IW\left(\texttt{nu}^{\ast}\texttt{=nu-dim(V)+1},\ \texttt{V}^{\ast}=\texttt{V[1,1]}\right)\)</span>
but this was a source of confusion and was changed.<a href="cat-int.html#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>In versions <span class="math inline">\(&lt;2.18\)</span> <code>cor</code> fitted what is now a <code>corg</code> structure.
The reason for the change is to keep the <code>asreml</code> and <code>MCMCglmm</code>
syntax equivalent. However, the <code>corgh</code> structure in asreml is a
reparameterised <code>us</code> structure whereas in <code>MCMCglmm</code> the variances
are fixed in the prior.<a href="cat-int.html#fnref6" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="glm.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cont-int.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["MCMCglmm-course-notes.pdf", "MCMCglmm-course-notes.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
